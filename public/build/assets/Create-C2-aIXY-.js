import{q as N,r as P,j as e,Y as F,y as A}from"./app-CO_10S4M.js";import{A as I}from"./authenticated-layout-Dvq62uX6.js";import{C as V,a as w,b as D,c as M}from"./card-mFQ3ciLT.js";import{L as i}from"./label-C2emlWuD.js";import{I as m}from"./input-CcCzwE1f.js";import{B as h}from"./button-aRElStvs.js";import{S as a,a as o,b as c,c as d,e as s}from"./select-Dlb3K254.js";import{C as T}from"./calendar-jJmzVgEo.js";import{P as k,a as E,b as L}from"./popover-CZFdqn2A.js";import{C as q}from"./react-icons.esm-BuSxRPok.js";import{f as _}from"./format-LUeNQFBy.js";import"./separator-Dm-yAzcY.js";import"./index-rL7vOnwv.js";import"./sun-BAcRSrPD.js";import"./users-y5LTLO3D.js";import"./log-out-9dmwXuXz.js";import"./index-B0_-bcuz.js";import"./index-B3NU6vDc.js";import"./chevron-down-DoG7op4_.js";function le(){const{students:x=[],plans:f=[],currencies:y=[],errors:v={}}=N().props,[n,C]=P.useState({studentsel:"",student_id:"",plan_id:"",custom_amount:"",currency_code:"",interval:"monthly",interval_count:"",discount_type:"",discount_value:"",effective_from:"",is_active:!0,notes:""}),u=n.student_id?x.find(t=>t.id===Number(n.student_id)):null,j=u!=null&&u.club_id?f.filter(t=>t.planable_type==="App\\Models\\Club"&&t.planable_id===u.club_id):[],l=(t,b)=>{C(S=>{const p={...S,[t]:b};return t==="student_id"&&(p.plan_id=""),p})},g=t=>{t.preventDefault(),A.post(route("club.student-fee-plans.store"),{student_id:n.student_id,plan_id:n.plan_id||null,custom_amount:n.custom_amount||null,currency_code:n.currency_code||null,interval:n.interval,interval_count:n.interval==="custom"?Number(n.interval_count||0):null,discount_type:n.discount_type||null,discount_value:n.discount_value?Number(n.discount_value):0,effective_from:n.effective_from||null,is_active:n.is_active,notes:n.notes||null})},r=t=>v[t]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:v[t]});return e.jsxs(I,{header:"Assign Student Fee Plan",children:[e.jsx(F,{title:"Assign Student Fee Plan"}),e.jsx("div",{className:"p-6",children:e.jsxs(V,{children:[e.jsx(w,{children:e.jsx(D,{children:"Assign Student Fee Plan"})}),e.jsx(M,{children:e.jsxs("form",{onSubmit:g,className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Student"}),e.jsxs(a,{value:n.student_id,onValueChange:t=>l("student_id",t),children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Select Student"})}),e.jsx(d,{children:x.map(t=>e.jsxs(s,{value:String(t.id),children:[t.name," ",t.surname||""]},t.id))})]}),r("student_id")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Plan"}),e.jsxs(a,{value:n.plan_id,onValueChange:t=>l("plan_id",t),disabled:!n.student_id,children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Select Plan (or leave blank for custom)"})}),e.jsx(d,{children:j.length>0?j.map(t=>e.jsxs(s,{value:String(t.id),children:[t.name," - ",t.currency_code," ",t.base_amount]},t.id)):e.jsx(s,{value:"none",disabled:!0,children:n.student_id?"No plans available for this student's club":"Select a student first"})})]}),r("plan_id")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Custom Amount (optional)"}),e.jsx(m,{value:n.custom_amount,onChange:t=>l("custom_amount",t.target.value),type:"number"}),r("custom_amount")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Currency (optional)"}),e.jsxs(a,{value:n.currency_code,onValueChange:t=>l("currency_code",t),children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Select Currency"})}),e.jsx(d,{children:y.map(t=>e.jsxs(s,{value:t.code,children:[t.code," - ",t.symbol," ",t.name]},t.code))})]}),r("currency_code")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Interval"}),e.jsxs(a,{value:n.interval,onValueChange:t=>l("interval",t),children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Select Interval"})}),e.jsxs(d,{children:[e.jsx(s,{value:"monthly",children:"Monthly"}),e.jsx(s,{value:"quarterly",children:"Quarterly"}),e.jsx(s,{value:"semester",children:"Semester"}),e.jsx(s,{value:"yearly",children:"Yearly"}),e.jsx(s,{value:"custom",children:"Custom (months)"})]})]}),r("interval")]}),n.interval==="custom"&&e.jsxs("div",{children:[e.jsx(i,{children:"Interval Count (months)"}),e.jsx(m,{value:n.interval_count,onChange:t=>l("interval_count",t.target.value),type:"number",min:1}),r("interval_count")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Discount Type"}),e.jsxs(a,{value:n.discount_type||"",onValueChange:t=>l("discount_type",t==="none"?"":t),children:[e.jsx(o,{children:e.jsx(c,{placeholder:"None"})}),e.jsxs(d,{children:[e.jsx(s,{value:"none",children:"None"}),e.jsx(s,{value:"percent",children:"Percent"}),e.jsx(s,{value:"fixed",children:"Fixed"})]})]}),r("discount_type")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Discount Value"}),e.jsx(m,{value:n.discount_value,onChange:t=>l("discount_value",t.target.value),type:"number",min:0}),r("discount_value")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Effective From"}),e.jsxs(k,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"w-full justify-start text-left font-normal "+(!n.effective_from&&"text-muted-foreground"),children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),n.effective_from?_(new Date(n.effective_from),"PPP"):"Pick a date"]})}),e.jsx(L,{className:"w-auto p-0",children:e.jsx(T,{mode:"single",selected:n.effective_from?new Date(n.effective_from):void 0,onSelect:t=>l("effective_from",t?_(t,"yyyy-MM-dd"):""),initialFocus:!0})})]}),r("effective_from")]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(i,{children:"Notes"}),e.jsx(m,{value:n.notes,onChange:t=>l("notes",t.target.value)}),r("notes")]}),e.jsxs("div",{className:"col-span-2 flex gap-3",children:[e.jsx(h,{type:"submit",children:"Save"}),e.jsx(h,{type:"button",variant:"outline",onClick:()=>history.back(),children:"Cancel"})]})]})})]})})]})}export{le as default};
