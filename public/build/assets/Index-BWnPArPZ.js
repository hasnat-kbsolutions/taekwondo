import{j as e,r as d,W as $,Y as q,b,y as I}from"./app-Qc4CeIVR.js";import{D as O}from"./DataTable-sBZnSdCx.js";import{B as h}from"./button-C_h6ToX0.js";import{C as G,a as H,b as Y,c as J}from"./card-aGJSTTtW.js";import{A as Q,D as X,a as Z,b as ee,c as f}from"./authenticated-layout-ky9aO383.js";import{L as n}from"./label-B7U_IG_r.js";import{S as P,a as A,b as E,c as T,e as x}from"./select-C0cthBOg.js";import{C as F}from"./country-dropdown-Es3F8izp.js";import{B as se}from"./badge-GE5GUWPt.js";import{R as W}from"./RatingStars-C8jT0J2a.js";import{D as V,a as K,b as z,c as k,d as U,e as te}from"./dialog-DvqGXoYj.js";import{I as L}from"./input-iz2NDNEj.js";import{F as B}from"./file-text-BEBqe29o.js";import{E as ae}from"./ellipsis-_bRBEkQo.js";import{E as re}from"./eye-Bj69TqAJ.js";import{S as ie}from"./square-pen-QhbxiAVX.js";import{K as le}from"./key-BXkENzWO.js";import{T as ne}from"./trash-2-Ca9vEPzt.js";import"./table-B63i6qjq.js";import"./separator-CgvCt5_y.js";import"./index-CnUrj3gZ.js";import"./createLucideIcon-775Dkrg4.js";import"./building-2-BOzU0Xrn.js";import"./users-AXSi9GuI.js";import"./log-out-D5ccv8f0.js";import"./calendar-CZxiGZ8L.js";import"./sun-C1Um4luV.js";import"./index-8jmc5Owj.js";import"./index-D46JdVQV.js";import"./chevron-down-Cz7cvS-S.js";import"./popover-BU4ogmC1.js";import"./globe-BHOLXFft.js";const oe=(v,p)=>[{header:"#",cell:({row:r})=>r.index+1},{id:"profile_image",header:"Photo",cell:({row:r})=>{const i=r.original.profile_image;if(i){const o=i.startsWith("http")?i:`/storage/${i}`;return e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:o,alt:"Profile",className:"w-10 h-10 rounded-full object-cover",onError:c=>{var m;c.currentTarget.style.display="none",(m=c.currentTarget.nextElementSibling)==null||m.classList.remove("hidden")}}),e.jsx("span",{className:"text-gray-400 italic text-xs hidden absolute inset-0 flex items-center justify-center",children:"No image"})]})}return e.jsx("span",{className:"text-gray-400 italic",children:"No image"})}},{accessorKey:"code",header:"Code"},{accessorKey:"name",header:"Name"},{accessorKey:"surname",header:"Surname"},{accessorKey:"dob",header:"DOB"},{accessorKey:"id_passport",header:"ID/Passport"},{id:"identification_document",header:"Documents",cell:({row:r})=>{const i=r.original.identification_document;if(i){const o=i.startsWith("http")?i:`/storage/${i}`;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-blue-500"}),e.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-xs underline",children:"View Doc"})]})}return e.jsx("span",{className:"text-gray-400 italic text-xs",children:"No doc"})}},{accessorKey:"email",header:"Email"},{accessorKey:"phone",header:"Phone"},{id:"rating",header:"Rating",cell:({row:r})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{rating:typeof r.original.average_rating=="number"?Math.round(r.original.average_rating):0,readonly:!0,size:"sm"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",r.original.total_ratings,")"]})]})},{accessorKey:"status",header:"Status",cell:({row:r})=>e.jsx(se,{variant:r.original.status?"default":"destructive",children:r.original.status?"Active":"Inactive"})},{id:"actions",header:"Actions",cell:({row:r})=>{const i=r.original;return e.jsxs(X,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsxs(ee,{align:"end",children:[e.jsxs(f,{onClick:()=>v(i),children:[e.jsx(re,{className:"w-4 h-4 mr-2"})," View"]}),e.jsx(f,{asChild:!0,children:e.jsxs(b,{href:route("organization.students.edit",i.id),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"})," Edit"]})}),p&&e.jsxs(f,{onClick:()=>p(i),children:[e.jsx(le,{className:"w-4 h-4 mr-2"})," Change Password"]}),e.jsx(f,{asChild:!0,children:e.jsxs(b,{href:route("organization.students.destroy",i.id),method:"delete",as:"button",children:[e.jsx(ne,{className:"w-4 h-4 mr-2"})," Delete"]})})]})]})}}];function Be({students:v,clubs:p=[],nationalities:r=[],countries:i=[],filters:o}){const[c,m]=d.useState(o.club_id||""),[N,y]=d.useState(o.nationality||""),[w,_]=d.useState(o.country||""),[C,S]=d.useState(o.status||""),[s,D]=d.useState(null),[u,g]=d.useState(null),l=$({password:"",password_confirmation:""}),M=t=>{D(t)},j=t=>{I.get(route("organization.students.index"),{club_id:t.club_id??(c||null),nationality:t.nationality??(N||null),country:t.country??(w||null),status:t.status??(C||null)},{preserveScroll:!0,preserveState:!0,replace:!0})},R=()=>{m(""),y(""),_(""),S(""),I.get(route("organization.students.index"),{},{preserveScroll:!0,preserveState:!1,replace:!0})};return e.jsxs(Q,{header:"Students",children:[e.jsx(q,{title:"Students"}),e.jsx("div",{className:"container mx-auto py-10",children:e.jsxs(G,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between",children:[e.jsx(Y,{children:"Students"}),e.jsx(b,{href:route("organization.students.create"),children:e.jsx(h,{children:"Add Student"})})]}),e.jsxs(J,{children:[e.jsx("div",{className:"mb-6 p-4 border rounded-lg bg-muted/50",children:e.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex flex-col w-[200px]",children:[e.jsx(n,{className:"text-sm mb-1",children:"Club"}),e.jsxs(P,{value:c,onValueChange:t=>{const a=t==="all"?"":t;m(a),j({club_id:a})},children:[e.jsx(A,{children:e.jsx(E,{placeholder:"All Clubs"})}),e.jsxs(T,{children:[e.jsx(x,{value:"all",children:"All"}),p.map(t=>e.jsx(x,{value:t.id.toString(),children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"w-[200px]",children:[e.jsx(n,{className:"text-sm mb-1",children:"Nationality"}),e.jsx(F,{placeholder:"All Nationalities",defaultValue:N||"",onChange:t=>{const a=(t==null?void 0:t.alpha3)||"";y(a),j({nationality:a})},slim:!1})]}),e.jsxs("div",{className:"w-[200px]",children:[e.jsx(n,{className:"text-sm mb-1",children:"Country"}),e.jsx(F,{placeholder:"All Countries",defaultValue:w||"",onChange:t=>{const a=(t==null?void 0:t.alpha3)||"";_(a),j({country:a})}})]}),e.jsxs("div",{className:"flex flex-col w-[200px]",children:[e.jsx(n,{className:"text-sm mb-1",children:"Status"}),e.jsxs(P,{value:C,onValueChange:t=>{const a=t==="all"?"":t;S(a),j({status:a})},children:[e.jsx(A,{children:e.jsx(E,{placeholder:"All Statuses"})}),e.jsxs(T,{children:[e.jsx(x,{value:"all",children:"All"}),e.jsx(x,{value:"active",children:"Active"}),e.jsx(x,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(h,{variant:"secondary",onClick:R,children:"Reset Filters"})})]})}),e.jsx(O,{columns:oe(M,t=>g(t)),data:v})]})]})}),e.jsx(V,{open:!!s,onOpenChange:()=>D(null),children:e.jsxs(K,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(z,{children:[e.jsx(k,{children:"Student Details"}),e.jsx(U,{children:"View detailed information about the student."})]}),s&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.profile_image?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.profile_image.startsWith("http")?s.profile_image:`/storage/${s.profile_image}`,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-2 border-gray-200 shadow-lg",onError:t=>{var a;t.currentTarget.style.display="none",(a=t.currentTarget.nextElementSibling)==null||a.classList.remove("hidden")}}),e.jsx("div",{className:"w-32 h-32 hidden flex items-center justify-center rounded-full bg-gray-100 text-gray-400 text-sm italic border-2 border-gray-200",children:"No Image"})]}):e.jsx("div",{className:"w-32 h-32 flex items-center justify-center rounded-full bg-gray-100 text-gray-400 text-sm italic border-2 border-gray-200",children:"No Image"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:[s.name," ",s.surname]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.code})]})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{label:"UID",value:s.uid},{label:"Email",value:s.email},{label:"Phone",value:s.phone},{label:"Grade",value:s.grade},{label:"Gender",value:s.gender},{label:"Nationality",value:s.nationality},{label:"Date of Birth",value:s.dob?new Date(s.dob).toLocaleDateString():"Not specified"},{label:"Date of Death",value:s.dod?new Date(s.dod).toLocaleDateString():"Not specified"},{label:"ID/Passport",value:s.id_passport},{label:"Identification Document",value:s.identification_document?e.jsx("a",{href:s.identification_document.startsWith("http")?s.identification_document:`/storage/${s.identification_document}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"View Document"}):"No document uploaded"},{label:"Street",value:s.street||"Not specified"},{label:"Postal Code",value:s.postal_code||"Not specified"},{label:"City",value:s.city||"Not specified"},{label:"Country",value:s.country||"Not specified"},{label:"Status",value:s.status?"Active":"Inactive"},{label:"Rating",value:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{rating:typeof s.average_rating=="number"?Math.round(s.average_rating):0,readonly:!0,size:"sm"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[typeof s.average_rating=="number"?s.average_rating.toFixed(1):"0.0"," ","(",s.total_ratings," ","ratings)"]})]})}].map((t,a)=>e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:t.label}),e.jsx("div",{className:"text-sm",children:t.value})]},a))}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Attachments"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Profile Image"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border-2 border-dashed border-gray-200 min-h-[200px] flex items-center justify-center",children:s.profile_image?e.jsx("img",{src:s.profile_image.startsWith("http")?s.profile_image:`/storage/${s.profile_image}`,alt:"Profile",className:"max-w-full max-h-48 object-contain rounded"}):e.jsx("span",{className:"text-gray-400 italic",children:"No profile image"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Identification Document"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border-2 border-dashed border-gray-200 min-h-[200px] flex items-center justify-center",children:s.identification_document?e.jsxs("div",{className:"text-center",children:[e.jsx(B,{className:"w-12 h-12 text-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"PDF Document Available"}),e.jsx("a",{href:s.identification_document.startsWith("http")?s.identification_document:`/storage/${s.identification_document}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline mt-1 inline-block",children:"View Document"})]}):e.jsx("span",{className:"text-gray-400 italic",children:"No identification document"})})]})]})]})]})]})}),u&&e.jsx(V,{open:!!u,onOpenChange:t=>{t||(g(null),l.reset())},children:e.jsxs(K,{children:[e.jsxs(z,{children:[e.jsx(k,{children:"Change Password"}),e.jsxs(U,{children:["Update password for ",u.name," ",u.surname]})]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),l.patch(route("organization.students.updatePassword",u.id),{onSuccess:()=>{g(null),l.reset()}})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(n,{htmlFor:"password",children:["New Password"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(L,{id:"password",type:"password",placeholder:"Enter new password",value:l.data.password,onChange:t=>l.setData("password",t.target.value),required:!0}),l.errors.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.errors.password})]}),e.jsxs("div",{children:[e.jsxs(n,{htmlFor:"password_confirmation",children:["Confirm Password"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(L,{id:"password_confirmation",type:"password",placeholder:"Confirm new password",value:l.data.password_confirmation,onChange:t=>l.setData("password_confirmation",t.target.value),required:!0}),l.errors.password_confirmation&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.errors.password_confirmation})]}),e.jsxs(te,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>{g(null),l.reset()},children:"Cancel"}),e.jsx(h,{type:"submit",disabled:l.processing,children:l.processing?"Updating...":"Update Password"})]})]})]})})]})}export{oe as columns,Be as default};
