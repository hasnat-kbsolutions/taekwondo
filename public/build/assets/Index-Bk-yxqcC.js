import{r as i,j as e,Y as J,b as x,y as T}from"./app-Qc4CeIVR.js";import{B as M}from"./button-C_h6ToX0.js";import{B as O}from"./badge-GE5GUWPt.js";import{A as H,B as K,D as U,a as W,b as $,c as o}from"./authenticated-layout-ky9aO383.js";import{S as g,a as v,b as f,c as b,e as n}from"./select-C0cthBOg.js";import{D as q}from"./DataTable-sBZnSdCx.js";import{C as c,a as d,b as m,c as h}from"./card-aGJSTTtW.js";import{L as y}from"./label-B7U_IG_r.js";import{W as k}from"./wallet-CRv35DU3.js";import{H as X}from"./hourglass-DJsTfEnc.js";import{C as z}from"./circle-x-CJ-FCGfy.js";import{E as G}from"./ellipsis-_bRBEkQo.js";import{S as Q}from"./square-pen-QhbxiAVX.js";import{C as Z}from"./circle-check-big-BLgVG8t6.js";import{T as ee}from"./trash-2-Ca9vEPzt.js";import{F as se}from"./file-text-BEBqe29o.js";import{D as ae}from"./download-CYA-a4cB.js";import"./input-iz2NDNEj.js";import"./separator-CgvCt5_y.js";import"./index-CnUrj3gZ.js";import"./createLucideIcon-775Dkrg4.js";import"./building-2-BOzU0Xrn.js";import"./users-AXSi9GuI.js";import"./log-out-D5ccv8f0.js";import"./calendar-CZxiGZ8L.js";import"./sun-C1Um4luV.js";import"./index-8jmc5Owj.js";import"./index-D46JdVQV.js";import"./chevron-down-Cz7cvS-S.js";import"./table-B63i6qjq.js";const te=[{header:"#",cell:({row:a})=>a.index+1},{header:"Student",cell:({row:a})=>{var t;return((t=a.original.student)==null?void 0:t.name)||"-"}},{header:"Amount",cell:({row:a})=>{var p;const t=a.original,r=t.amount,l=t.currency_code,N=((p=t.currency)==null?void 0:p.symbol)||l,u=P(r,l);return e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:[l==="MYR"?"RM ":N,u]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:l})]})}},{header:"Status",cell:({row:a})=>e.jsx(O,{variant:a.original.status==="paid"||a.original.status==="success"?"default":"destructive",children:a.original.status})},{header:"Method",accessorKey:"method"},{header:"Payment Month",accessorKey:"payment_month"},{header:"Pay At",accessorKey:"pay_at"},{header:"Actions",cell:({row:a})=>e.jsxs(U,{children:[e.jsx(W,{asChild:!0,children:e.jsx(M,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(G,{className:"h-4 w-4"})})}),e.jsxs($,{align:"end",children:[e.jsx(o,{asChild:!0,children:e.jsxs(x,{href:route("organization.payments.edit",a.original.id),children:[e.jsx(Q,{className:"w-4 h-4 mr-2"})," Edit"]})}),a.original.status==="unpaid"&&e.jsx(o,{asChild:!0,children:e.jsxs(x,{href:route("organization.payments.updateStatus",a.original.id),method:"patch",data:{status:"paid"},as:"button",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"})," Mark as Paid"]})}),(a.original.status==="paid"||a.original.status==="success")&&e.jsx(o,{asChild:!0,children:e.jsxs(x,{href:route("organization.payments.updateStatus",a.original.id),method:"patch",data:{status:"unpaid"},as:"button",children:[e.jsx(z,{className:"w-4 h-4 mr-2"})," Mark as Unpaid"]})}),e.jsx(o,{asChild:!0,children:e.jsxs(x,{href:route("organization.payments.destroy",a.original.id),method:"delete",as:"button",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Delete"]})}),e.jsx(o,{asChild:!0,children:e.jsxs(x,{href:route("invoice.show",{payment:a.original.id}),children:[e.jsx(se,{className:"w-4 h-4 mr-2"})," Invoice"]})}),e.jsxs(o,{onClick:t=>{t.preventDefault();const r=route("invoice.download",{payment:a.original.id});window.open(r,"_blank")},children:[e.jsx(ae,{className:"w-4 h-4 mr-2"})," Download Invoice"]})]})]})}],re=new Date().getFullYear(),le=["All",...Array.from({length:5},(a,t)=>(re-t).toString())],ne=[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}],P=(a,t)=>{const r=Number(a)||0;return t==="JPY"?r.toLocaleString():r.toFixed(2)};function Ee({payments:a,filters:t,amountsByCurrency:r={},defaultCurrencyCode:l="MYR",currencies:N=[]}){var Y;const[u,p]=i.useState(t.status||""),[w,D]=i.useState(t.currency_code||""),[S,_]=i.useState(t.payment_month?t.payment_month.length===4?t.payment_month:t.payment_month.split("-")[0]:"All"),[A,C]=i.useState(((Y=t.payment_month)==null?void 0:Y.split("-")[1])||""),F=({year:s,month:j,status:L,currency:B})=>{const V=s==="All"?"":j?`${s}-${j}`:s;T.get(route("organization.payments.index"),{status:L||null,payment_month:V||null,currency_code:B||null},{preserveScroll:!0,preserveState:!0,replace:!0})},[R,E]=i.useState(!0);i.useEffect(()=>{if(R){E(!1);return}F({year:S,month:A,status:u,currency:w})},[S,A,u,w]);const I=()=>{p(""),_("All"),C(""),D(""),T.get(route("organization.payments.index"),{},{preserveScroll:!0,preserveState:!1,replace:!0})};return e.jsxs(H,{header:"Payments",children:[e.jsx(J,{title:"Payments"}),e.jsxs("div",{className:"container mx-auto py-10 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-muted-foreground",children:"Payment Overview"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 mb-6",children:[e.jsxs(c,{className:"hover:shadow-lg transition-all duration-200 cursor-pointer hover:bg-accent/50 border-2 hover:border-primary/20 col-span-1 sm:col-span-2 lg:col-span-3 xl:col-span-4",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium group-hover:text-primary transition-colors",children:"Total Revenue"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(k,{className:"h-6 w-6 text-primary"})})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold group-hover:text-primary transition-colors",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[l==="MYR"?"RM":l," ",P(r[l]||0,l)]}),Object.keys(r).length>1&&e.jsx("div",{className:"text-xs text-muted-foreground space-y-1",children:Object.entries(r).filter(([s])=>s!==l).map(([s,j])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[s,":"]}),e.jsx("span",{children:P(j,s)})]},s))})]})})})]}),e.jsxs(c,{className:"hover:shadow-lg transition-all duration-200 cursor-pointer hover:bg-accent/50 border-2 hover:border-primary/20",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium group-hover:text-primary transition-colors",children:"Total Payments"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(k,{className:"h-6 w-6 text-primary"})})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold group-hover:text-primary transition-colors",children:a.length})})]}),e.jsxs(c,{className:"hover:shadow-lg transition-all duration-200 cursor-pointer hover:bg-accent/50 border-2 hover:border-primary/20",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium group-hover:text-primary transition-colors",children:"Paid"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(K,{className:"h-6 w-6 text-green-600"})})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold group-hover:text-primary transition-colors",children:a.filter(s=>s.status==="paid").length})})]}),e.jsxs(c,{className:"hover:shadow-lg transition-all duration-200 cursor-pointer hover:bg-accent/50 border-2 hover:border-primary/20",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium group-hover:text-primary transition-colors",children:"Pending"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(X,{className:"h-6 w-6 text-yellow-500"})})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold group-hover:text-primary transition-colors",children:a.filter(s=>s.status==="pending").length})})]}),e.jsxs(c,{className:"hover:shadow-lg transition-all duration-200 cursor-pointer hover:bg-accent/50 border-2 hover:border-primary/20",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium group-hover:text-primary transition-colors",children:"Unpaid"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(z,{className:"h-6 w-6 text-red-600"})})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold group-hover:text-primary transition-colors text-red-600",children:a.filter(s=>s.status==="unpaid").length})})]})]})]}),e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between",children:[e.jsx(m,{children:"Payments"}),e.jsx(x,{href:route("organization.payments.create"),children:e.jsx(M,{children:"Add Payment"})})]}),e.jsxs(h,{children:[e.jsx("div",{className:"mb-6 p-4 border rounded-lg bg-muted/50",children:e.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(y,{className:"text-sm mb-1",children:"Year"}),e.jsxs(g,{value:S,onValueChange:s=>{_(s),s==="All"&&C("")},children:[e.jsx(v,{children:e.jsx(f,{placeholder:"Year"})}),e.jsx(b,{children:le.map(s=>e.jsx(n,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(y,{className:"text-sm mb-1",children:"Month"}),e.jsxs(g,{value:A,onValueChange:s=>C(s==="all"?"":s),children:[e.jsx(v,{children:e.jsx(f,{placeholder:"Month"})}),e.jsxs(b,{children:[e.jsx(n,{value:"all",children:"All"}),ne.map(s=>e.jsx(n,{value:s.value,children:s.label},s.value))]})]})]}),e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(y,{className:"text-sm mb-1",children:"Status"}),e.jsxs(g,{value:u,onValueChange:s=>p(s==="all"?"":s),children:[e.jsx(v,{children:e.jsx(f,{placeholder:"All Statuses"})}),e.jsxs(b,{children:[e.jsx(n,{value:"all",children:"All"}),e.jsx(n,{value:"paid",children:"Paid"}),e.jsx(n,{value:"unpaid",children:"Unpaid"})]})]})]}),e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(y,{className:"text-sm mb-1",children:"Currency"}),e.jsxs(g,{value:w,onValueChange:s=>D(s==="all"?"":s),children:[e.jsx(v,{children:e.jsx(f,{placeholder:"All Currencies"})}),e.jsxs(b,{children:[e.jsx(n,{value:"all",children:"All"}),N.map(s=>e.jsxs(n,{value:s.code,children:[s.code," -"," ",s.symbol]},s.code))]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(M,{variant:"secondary",onClick:I,children:"Reset Filters"})})]})}),e.jsx(q,{data:a,columns:te})]})]})]})]})}export{Ee as default};
