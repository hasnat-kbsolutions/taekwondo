import{j as e,b as g,q as Q,r,Y as X,y as W}from"./app-DT13sNDJ.js";import{D as Z}from"./DataTable-uKC-sYyp.js";import{B as p}from"./button-_MPKCyHU.js";import{D as ee,a as te,b as ae,c as w,A as se}from"./authenticated-layout-Cx1UTSKQ.js";import{B as le}from"./badge-DVNGBW-c.js";import{R as q}from"./RatingStars-QjpEwtxI.js";import{F as ie}from"./file-text-COgwhKB0.js";import{E as re}from"./ellipsis-DZj6lG82.js";import{E as ne}from"./eye-B0nTGq9M.js";import{S as oe}from"./square-pen-ClW5kTRS.js";import{T as de}from"./trash-2-DWkcHDiZ.js";import{C as D,a as I,b as z,c as E}from"./card-DvyRDZ49.js";import{L as u}from"./label-DUjCpFhQ.js";import{S as A,a as T,b as F,c as $,e as d}from"./select-gAEyQ-Ek.js";import{C as k}from"./country-dropdown-BFQTOwJZ.js";import{D as ce,a as ue,b as me,c as he,d as xe}from"./dialog-BHKuNyKn.js";import{s as x}from"./index-sFwGSaal.js";import"./table-DKIzpByk.js";import"./input-2s6pPNzp.js";import"./separator-oS8k4mHV.js";import"./index-BVHmHscH.js";import"./createLucideIcon-CDCLNRtp.js";import"./building-2-Dmaaj3kn.js";import"./users-GnOVMNQc.js";import"./log-out-DZdJrOvn.js";import"./sun-CNh23O19.js";import"./index-RCdHDkqR.js";import"./index-g2AH_h-X.js";import"./chevron-down-Bm3UrJxU.js";import"./popover-DycIJqd6.js";import"./globe-DAD1tv2M.js";const ge=f=>[{header:"#",cell:({row:s})=>s.index+1},{id:"profile_image",header:"Photo",cell:({row:s})=>{const l=s.original.profile_image;if(l){const h=l.startsWith("http")?l:`/storage/${l}`;return e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:h,alt:"Profile",className:"w-10 h-10 rounded-full object-cover",onError:j=>{var n;j.currentTarget.style.display="none",(n=j.currentTarget.nextElementSibling)==null||n.classList.remove("hidden")}}),e.jsx("span",{className:"text-gray-400 italic text-xs hidden absolute inset-0 flex items-center justify-center",children:"No image"})]})}return e.jsx("span",{className:"text-gray-400 italic",children:"No image"})}},{accessorKey:"code",header:"Code"},{accessorKey:"name",header:"Name",cell:({row:s})=>e.jsx(g,{href:route("admin.student-insights.show",s.original.id),className:"text-blue-600 hover:text-blue-800 hover:underline font-medium",children:s.original.name})},{accessorKey:"surname",header:"Surname"},{accessorKey:"dob",header:"DOB"},{accessorKey:"id_passport",header:"ID/Passport"},{accessorKey:"email",header:"Email"},{accessorKey:"phone",header:"Phone"},{id:"organization",header:"Organization",cell:({row:s})=>{var l;return((l=s.original.organization)==null?void 0:l.name)||"Not specified"}},{id:"club",header:"Club",cell:({row:s})=>{var l;return((l=s.original.club)==null?void 0:l.name)||"Not specified"}},{id:"identification_document",header:"Documents",cell:({row:s})=>{const l=s.original.identification_document;if(l){const h=l.startsWith("http")?l:`/storage/${l}`;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-blue-500"}),e.jsx("a",{href:h,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-xs underline",children:"View Doc"})]})}return e.jsx("span",{className:"text-gray-400 italic text-xs",children:"No doc"})}},{id:"rating",header:"Rating",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{rating:typeof s.original.average_rating=="number"?Math.round(s.original.average_rating):0,readonly:!0,size:"sm"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",s.original.total_ratings,")"]})]})},{accessorKey:"status",header:"Status",cell:({row:s})=>e.jsx(le,{variant:s.original.status?"default":"destructive",children:s.original.status?"Active":"Inactive"})},{id:"actions",header:"Actions",cell:({row:s})=>{const l=s.original;return e.jsxs(ee,{children:[e.jsx(te,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(re,{className:"h-4 w-4"})})}),e.jsxs(ae,{align:"end",children:[e.jsxs(w,{onClick:()=>f(l),children:[e.jsx(ne,{className:"w-4 h-4 mr-2"})," View"]}),e.jsx(w,{asChild:!0,children:e.jsxs(g,{href:route("admin.students.edit",l.id),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"})," Edit"]})}),e.jsx(w,{asChild:!0,children:e.jsxs(g,{href:route("admin.students.destroy",l.id),method:"delete",as:"button",children:[e.jsx(de,{className:"w-4 h-4 mr-2"})," Delete"]})})]})]})}}];function Ye({students:f,organizations:s=[],clubs:l=[],nationalities:h=[],countries:j=[],filters:n}){var M,R,U;const{props:v}=Q(),[pe,G]=r.useState(!1),[fe,H]=r.useState([]),[b,P]=r.useState(n.organization_id||"all"),[N,V]=r.useState(n.club_id||"all"),[y,L]=r.useState(n.nationality||"all"),[S,K]=r.useState(n.country||"all"),[C,O]=r.useState(n.status||"all"),[a,B]=r.useState(null);r.useEffect(()=>{var t;if((t=v.flash)!=null&&t.import_log){const i=v.flash.import_log;let o=i.find(c=>c.summary),J=i.filter(c=>c.status),_=[];o&&_.push(`Total: ${o.total}, Success: ${o.success}, Failed: ${o.failed}, Percentage: ${o.percentage}%`+(o.error?`, Error: ${o.error}`:"")),J.forEach(c=>{_.push(`${c.status==="success"?"✅":"❌"} ${c.message}`)}),H(_),G(!0)}},[(M=v.flash)==null?void 0:M.import_log]);const m=t=>{W.get(x("admin.students.index"),{organization_id:t.organization_id??(b!=="all"?b:null),club_id:t.club_id??(N!=="all"?N:null),nationality:t.nationality??(y||null),country:t.country??(S||null),status:t.status??(C!=="all"?C:null)},{preserveScroll:!0,preserveState:!0,replace:!0})},Y=()=>{P("all"),V("all"),L(""),K(""),O("all"),W.get(x("admin.students.index"),{},{preserveScroll:!0,preserveState:!1,replace:!0})};return e.jsxs(se,{header:"Students",children:[e.jsx(X,{title:"Students"}),e.jsxs("div",{className:"container-fluid py-10 w-full",children:[e.jsxs(D,{children:[e.jsx(I,{className:"flex  flex-row items-center justify-between",children:e.jsx(z,{children:"Import / Export Students"})}),e.jsx(E,{children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:e.jsx(p,{asChild:!0,variant:"outline",children:e.jsx("a",{href:x("admin.students.export"),children:"Export Students"})})})})]}),e.jsxs(D,{className:"my-6",children:[e.jsx(I,{children:e.jsx(z,{children:"Filters"})}),e.jsx(E,{children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"organization",children:"Organization"}),e.jsxs(A,{value:b,onValueChange:t=>{P(t),m({organization_id:t})},children:[e.jsx(T,{id:"organization",className:"w-48",children:e.jsx(F,{placeholder:"All Organizations"})}),e.jsxs($,{children:[e.jsx(d,{value:"all",children:"All"}),s.map(t=>e.jsx(d,{value:String(t.id),children:t.name},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"club",children:"Club"}),e.jsxs(A,{value:N,onValueChange:t=>{V(t),m({club_id:t})},children:[e.jsx(T,{id:"club",className:"w-48",children:e.jsx(F,{placeholder:"All Clubs"})}),e.jsxs($,{children:[e.jsx(d,{value:"all",children:"All"}),l.map(t=>e.jsx(d,{value:String(t.id),children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"w-[200px]",children:[e.jsx(u,{className:"text-sm mb-1",children:"Nationality"}),e.jsx(k,{placeholder:"All Nationalities",defaultValue:y||"",onChange:t=>{const i=(t==null?void 0:t.alpha3)||"";L(i),m({nationality:i})},slim:!1})]}),e.jsxs("div",{className:"w-[200px]",children:[e.jsx(u,{className:"text-sm mb-1",children:"Country"}),e.jsx(k,{placeholder:"All Countries",defaultValue:S||"",onChange:t=>{const i=(t==null?void 0:t.alpha3)||"";K(i),m({country:i})},slim:!1})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"status",children:"Status"}),e.jsxs(A,{value:C,onValueChange:t=>{O(t),m({status:t})},children:[e.jsx(T,{id:"status",className:"w-32",children:e.jsx(F,{placeholder:"All Statuses"})}),e.jsxs($,{children:[e.jsx(d,{value:"all",children:"All"}),e.jsx(d,{value:"active",children:"Active"}),e.jsx(d,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx("div",{children:e.jsx(p,{variant:"secondary",onClick:Y,children:"Reset Filters"})})]})})]}),e.jsxs(D,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between",children:[e.jsx(z,{children:"Students"}),e.jsx(g,{href:x("admin.students.create"),children:e.jsx(p,{children:"Add Student"})})]}),e.jsx(E,{children:e.jsx(Z,{columns:ge(t=>B(t)),data:f})})]}),a&&e.jsx(ce,{open:!!a,onOpenChange:t=>{t||B(null)},children:e.jsxs(ue,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(me,{children:[e.jsx(he,{children:"Student Details"}),e.jsx(xe,{children:"View detailed information about the student."})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.profile_image?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a.profile_image.startsWith("http")?a.profile_image:`/storage/${a.profile_image}`,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-2 border-gray-200 shadow-lg",onError:t=>{var i;t.currentTarget.style.display="none",(i=t.currentTarget.nextElementSibling)==null||i.classList.remove("hidden")}}),e.jsx("div",{className:"w-32 h-32 hidden flex items-center justify-center rounded-full bg-gray-100 text-gray-400 text-sm italic border-2 border-gray-200",children:"No Image"})]}):e.jsx("div",{className:"w-32 h-32 flex items-center justify-center rounded-full bg-gray-100 text-gray-400 text-sm italic border-2 border-gray-200",children:"No Image"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:[a.name," ",a.surname]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.code})]})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{label:"UID",value:a.uid},{label:"Email",value:a.email},{label:"Phone",value:a.phone},{label:"Grade",value:a.grade},{label:"Gender",value:a.gender},{label:"Nationality",value:a.nationality},{label:"Date of Birth",value:a.dob?new Date(a.dob).toLocaleDateString():"Not specified"},{label:"Date of Death",value:a.dod?new Date(a.dod).toLocaleDateString():"Not specified"},{label:"ID/Passport",value:a.id_passport},{label:"Identification Document",value:a.identification_document?e.jsx("a",{href:a.identification_document.startsWith("http")?a.identification_document:`/storage/${a.identification_document}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"View Document"}):"No document uploaded"},{label:"Website",value:a.website||"Not specified"},{label:"Street",value:a.street||"Not specified"},{label:"Postal Code",value:a.postal_code||"Not specified"},{label:"City",value:a.city||"Not specified"},{label:"Country",value:a.country||"Not specified"},{label:"Organization",value:((R=a.organization)==null?void 0:R.name)||"Not specified"},{label:"Club",value:((U=a.club)==null?void 0:U.name)||"Not specified"},{label:"Status",value:a.status?"Active":"Inactive"},{label:"Rating",value:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{rating:typeof a.average_rating=="number"?Math.round(a.average_rating):0,readonly:!0,size:"sm"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[typeof a.average_rating=="number"?a.average_rating.toFixed(1):"0.0"," ","(",a.total_ratings," ","ratings)"]})]})}].map((t,i)=>e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:t.label}),e.jsx("div",{className:"text-sm",children:t.value})]},i))})]})]})})]})]})}export{Ye as default};
