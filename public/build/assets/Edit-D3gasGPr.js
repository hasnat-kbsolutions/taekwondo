import{q as M,r as T,j as e,Y as k,y as L}from"./app-CC7qpNu6.js";import{A as q}from"./authenticated-layout-Bd5hei_t.js";import{C as B,a as Y,b as H,c as Q}from"./card-CUFGxmYR.js";import{L as a}from"./label-DaD98WMX.js";import{I as v}from"./input-B5ij4QCV.js";import{B as p}from"./button-Dawy7JlE.js";import{S as o,a as c,b as d,c as u,e as n}from"./select-n3OOaBTe.js";import{C as R}from"./calendar-CuXE0pNT.js";import{P as z,a as G,b as J}from"./popover-BCwEgVmg.js";import{C as K}from"./react-icons.esm-Bd2a4Y4N.js";import{f as N}from"./format-LUeNQFBy.js";import"./separator-BtGUCeNx.js";import"./index-AMtJWCSb.js";import"./sun-Cdo4h1aO.js";import"./users-DF6lFF4e.js";import"./log-out-tpPZZpB-.js";import"./index-BCDJZF4r.js";import"./index-BReCHXkN.js";import"./chevron-down--P3qsrMs.js";function ue(){var h,g,x,C,j,S;const{studentFeePlan:r,students:f=[],plans:E=[],currencies:I=[],errors:_={}}=M().props,[i,V]=T.useState({student_id:r!=null&&r.student_id?String(r.student_id):"",plan_id:r!=null&&r.plan_id?String(r.plan_id):"",custom_amount:((g=(h=r==null?void 0:r.custom_amount)==null?void 0:h.toString)==null?void 0:g.call(h))||"",currency_code:(r==null?void 0:r.currency_code)||"",interval:(r==null?void 0:r.interval)||"monthly",interval_count:((C=(x=r==null?void 0:r.interval_count)==null?void 0:x.toString)==null?void 0:C.call(x))||"",discount_type:(r==null?void 0:r.discount_type)||"",discount_value:((S=(j=r==null?void 0:r.discount_value)==null?void 0:j.toString)==null?void 0:S.call(j))||"",effective_from:(r==null?void 0:r.effective_from)||"",is_active:!!(r!=null&&r.is_active),notes:(r==null?void 0:r.notes)||""}),m=i.student_id?f.find(t=>t.id===Number(i.student_id)):null,y=m!=null&&m.club_id?E.filter(t=>t.planable_type==="App\\Models\\Club"&&t.planable_id===m.club_id):[],s=(t,D)=>{V(A=>{const b={...A,[t]:D};return t==="student_id"&&(b.plan_id=""),b})},w=t=>{t.preventDefault(),L.post(route("admin.student-fee-plans.update",r.id),{...i,_method:"put"})},l=t=>_[t]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:_[t]});return e.jsxs(q,{header:"Edit Student Fee Plan",children:[e.jsx(k,{title:"Edit Student Fee Plan"}),e.jsx("div",{className:"p-6",children:e.jsxs(B,{children:[e.jsx(Y,{children:e.jsx(H,{children:"Edit Student Fee Plan"})}),e.jsx(Q,{children:e.jsxs("form",{onSubmit:w,className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Student"}),e.jsxs(o,{value:i.student_id,onValueChange:t=>s("student_id",t),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select Student"})}),e.jsx(u,{children:f.map(t=>e.jsxs(n,{value:String(t.id),children:[t.name," ",t.surname||""]},t.id))})]}),l("student_id")]}),e.jsxs("div",{children:[e.jsx(a,{children:"Plan"}),e.jsxs(o,{value:i.plan_id,onValueChange:t=>s("plan_id",t),disabled:!i.student_id,children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select Plan (or leave blank for custom)"})}),e.jsx(u,{children:y.length>0?y.map(t=>e.jsxs(n,{value:String(t.id),children:[t.name," - ",t.currency_code," ",t.base_amount]},t.id)):e.jsx(n,{value:"none",disabled:!0,children:i.student_id?"No plans available for this student's club":"Select a student first"})})]}),l("plan_id")]}),e.jsxs("div",{children:[e.jsx(a,{children:"Custom Amount (optional)"}),e.jsx(v,{value:i.custom_amount,onChange:t=>s("custom_amount",t.target.value),type:"number"}),l("custom_amount")]}),e.jsxs("div",{children:[e.jsx(a,{children:"Currency (optional)"}),e.jsxs(o,{value:i.currency_code,onValueChange:t=>s("currency_code",t),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select Currency"})}),e.jsx(u,{children:I.map(t=>e.jsxs(n,{value:t.code,children:[t.code," - ",t.symbol," ",t.name]},t.code))})]}),l("currency_code")]}),e.jsxs("div",{children:[e.jsx(a,{children:"Interval"}),e.jsxs(o,{value:i.interval,onValueChange:t=>s("interval",t),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select Interval"})}),e.jsxs(u,{children:[e.jsx(n,{value:"monthly",children:"Monthly"}),e.jsx(n,{value:"quarterly",children:"Quarterly"}),e.jsx(n,{value:"semester",children:"Semester"}),e.jsx(n,{value:"yearly",children:"Yearly"}),e.jsx(n,{value:"custom",children:"Custom (months)"})]})]}),l("interval")]}),i.interval==="custom"&&e.jsxs("div",{children:[e.jsx(a,{children:"Interval Count (months)"}),e.jsx(v,{value:i.interval_count,onChange:t=>s("interval_count",t.target.value),type:"number",min:1}),l("interval_count")]}),e.jsxs("div",{children:[e.jsx(a,{children:"Discount Type"}),e.jsxs(o,{value:i.discount_type||"",onValueChange:t=>s("discount_type",t==="none"?"":t),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"None"})}),e.jsxs(u,{children:[e.jsx(n,{value:"none",children:"None"}),e.jsx(n,{value:"percent",children:"Percent"}),e.jsx(n,{value:"fixed",children:"Fixed"})]})]}),l("discount_type")]}),e.jsxs("div",{children:[e.jsx(a,{children:"Discount Value"}),e.jsx(v,{value:i.discount_value,onChange:t=>s("discount_value",t.target.value),type:"number",min:0}),l("discount_value")]}),e.jsxs("div",{children:[e.jsx(a,{children:"Effective From"}),e.jsxs(z,{children:[e.jsx(G,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"w-full justify-start text-left font-normal "+(!i.effective_from&&"text-muted-foreground"),children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),i.effective_from?N(new Date(i.effective_from),"PPP"):"Pick a date"]})}),e.jsx(J,{className:"w-auto p-0",children:e.jsx(R,{mode:"single",selected:i.effective_from?new Date(i.effective_from):void 0,onSelect:t=>s("effective_from",t?N(t,"yyyy-MM-dd"):""),initialFocus:!0})})]}),l("effective_from")]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(a,{children:"Notes"}),e.jsx(v,{value:i.notes,onChange:t=>s("notes",t.target.value)}),l("notes")]}),e.jsxs("div",{className:"col-span-2 flex gap-3",children:[e.jsx(p,{type:"submit",children:"Save"}),e.jsx(p,{type:"button",variant:"outline",onClick:()=>history.back(),children:"Cancel"})]})]})})]})})]})}export{ue as default};
