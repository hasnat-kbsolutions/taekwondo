import{j as e,b as P,q as U,r,Y,y as M}from"./app-DTQk7vxO.js";import{D as J}from"./DataTable-DfOZR7zM.js";import{B as h}from"./button-CWNR-vJJ.js";import{D as Q,a as W,b as X,c as S,A as Z}from"./authenticated-layout-CC74nmYh.js";import{B as ee}from"./badge-CkJnoIhx.js";import{R as O}from"./RatingStars-dkC4rdri.js";import{E as se}from"./ellipsis-kV8jHywm.js";import{E as ae}from"./eye-DZmgEU3K.js";import{S as te}from"./square-pen-CNfrKdL3.js";import{T as le}from"./trash-2-BLHKxCog.js";import{C,a as _,b as w,c as D}from"./card-IdKNm35h.js";import{L as i}from"./label-D5atn-hE.js";import{S as I,a as A,b as E,c as z,e as d}from"./select-C2jbp9A4.js";import{C as R}from"./country-dropdown-CaqJALih.js";import{D as re,a as ie,b as ne,c as de,d as oe}from"./dialog-Bw2hNP4a.js";import{s as x}from"./index-sFwGSaal.js";import"./table-_7vXIEUi.js";import"./input-Bg81MIu0.js";import"./separator-C00dqrTm.js";import"./index-SIYl0Iv-.js";import"./sun-DpprhLd3.js";import"./users-CqSFjye9.js";import"./log-out-BKeuGqX9.js";import"./index-DiFbUrIw.js";import"./index-B8ANasXJ.js";import"./chevron-down-0Kdm1Tqi.js";import"./popover-Cukv8_id.js";import"./globe-CbJuoGOO.js";const ce=g=>[{header:"#",cell:({row:t})=>t.index+1},{id:"profile_image",header:"Photo",cell:({row:t})=>t.original.profile_image?e.jsx("img",{src:t.original.profile_image,alt:"Profile",className:"w-10 h-10 rounded-full object-cover"}):e.jsx("span",{className:"text-gray-400 italic",children:"No image"})},{accessorKey:"code",header:"Code"},{accessorKey:"name",header:"Name"},{accessorKey:"surname",header:"Surname"},{accessorKey:"dob",header:"DOB"},{accessorKey:"id_passport",header:"ID/Passport"},{accessorKey:"email",header:"Email"},{accessorKey:"phone",header:"Phone"},{id:"rating",header:"Rating",cell:({row:t})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{rating:typeof t.original.average_rating=="number"?Math.round(t.original.average_rating):0,readonly:!0,size:"sm"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",t.original.total_ratings,")"]})]})},{accessorKey:"status",header:"Status",cell:({row:t})=>e.jsx(ee,{variant:t.original.status?"default":"destructive",children:t.original.status?"Active":"Inactive"})},{id:"actions",header:"Actions",cell:({row:t})=>{const c=t.original;return e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(se,{className:"h-4 w-4"})})}),e.jsxs(X,{align:"end",children:[e.jsxs(S,{onClick:()=>g(c),children:[e.jsx(ae,{className:"w-4 h-4 mr-2"})," View"]}),e.jsx(S,{asChild:!0,children:e.jsxs(P,{href:route("admin.students.edit",c.id),children:[e.jsx(te,{className:"w-4 h-4 mr-2"})," Edit"]})}),e.jsx(S,{asChild:!0,children:e.jsxs(P,{href:route("admin.students.destroy",c.id),method:"delete",as:"button",children:[e.jsx(le,{className:"w-4 h-4 mr-2"})," Delete"]})})]})]})}}];function ke({students:g,organizations:t=[],clubs:c=[],nationalities:me=[],countries:ue=[],filters:m}){var L;const{props:p}=U(),[xe,k]=r.useState(!1),[he,q]=r.useState([]),[j,F]=r.useState(m.organization_id||"all"),[f,K]=r.useState(m.club_id||"all"),[v,T]=r.useState(m.nationality||"all"),[y,V]=r.useState(m.country||"all"),[N,$]=r.useState(m.status||"all"),[a,B]=r.useState(null);r.useEffect(()=>{var s;if((s=p.flash)!=null&&s.import_log){const l=p.flash.import_log;let n=l.find(o=>o.summary),H=l.filter(o=>o.status),b=[];n&&b.push(`Total: ${n.total}, Success: ${n.success}, Failed: ${n.failed}, Percentage: ${n.percentage}%`+(n.error?`, Error: ${n.error}`:"")),H.forEach(o=>{b.push(`${o.status==="success"?"✅":"❌"} ${o.message}`)}),q(b),k(!0)}},[(L=p.flash)==null?void 0:L.import_log]);const u=s=>{M.get(x("admin.students.index"),{organization_id:s.organization_id??(j!=="all"?j:null),club_id:s.club_id??(f!=="all"?f:null),nationality:s.nationality??(v||null),country:s.country??(y||null),status:s.status??(N!=="all"?N:null)},{preserveScroll:!0,preserveState:!0,replace:!0})},G=()=>{F("all"),K("all"),T(""),V(""),$("all"),M.get(x("admin.students.index"),{},{preserveScroll:!0,preserveState:!1,replace:!0})};return e.jsxs(Z,{header:"Students",children:[e.jsx(Y,{title:"Students"}),e.jsxs("div",{className:"container-fluid py-10 w-full",children:[e.jsxs(C,{children:[e.jsx(_,{className:"flex  flex-row items-center justify-between",children:e.jsx(w,{children:"Import / Export Students"})}),e.jsx(D,{children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:e.jsx(h,{asChild:!0,variant:"outline",children:e.jsx("a",{href:x("admin.students.export"),children:"Export Students"})})})})]}),e.jsxs(C,{className:"my-6",children:[e.jsx(_,{children:e.jsx(w,{children:"Filters"})}),e.jsx(D,{children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"organization",children:"Organization"}),e.jsxs(I,{value:j,onValueChange:s=>{F(s),u({organization_id:s})},children:[e.jsx(A,{id:"organization",className:"w-48",children:e.jsx(E,{placeholder:"All Organizations"})}),e.jsxs(z,{children:[e.jsx(d,{value:"all",children:"All"}),t.map(s=>e.jsx(d,{value:String(s.id),children:s.name},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"club",children:"Club"}),e.jsxs(I,{value:f,onValueChange:s=>{K(s),u({club_id:s})},children:[e.jsx(A,{id:"club",className:"w-48",children:e.jsx(E,{placeholder:"All Clubs"})}),e.jsxs(z,{children:[e.jsx(d,{value:"all",children:"All"}),c.map(s=>e.jsx(d,{value:String(s.id),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"w-[200px]",children:[e.jsx(i,{className:"text-sm mb-1",children:"Nationality"}),e.jsx(R,{placeholder:"All Nationalities",defaultValue:v||"",onChange:s=>{const l=(s==null?void 0:s.alpha3)||"";T(l),u({nationality:l})},slim:!1})]}),e.jsxs("div",{className:"w-[200px]",children:[e.jsx(i,{className:"text-sm mb-1",children:"Country"}),e.jsx(R,{placeholder:"All Countries",defaultValue:y||"",onChange:s=>{const l=(s==null?void 0:s.alpha3)||"";V(l),u({country:l})},slim:!1})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"status",children:"Status"}),e.jsxs(I,{value:N,onValueChange:s=>{$(s),u({status:s})},children:[e.jsx(A,{id:"status",className:"w-32",children:e.jsx(E,{placeholder:"All Statuses"})}),e.jsxs(z,{children:[e.jsx(d,{value:"all",children:"All"}),e.jsx(d,{value:"active",children:"Active"}),e.jsx(d,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx("div",{children:e.jsx(h,{variant:"secondary",onClick:G,children:"Reset Filters"})})]})})]}),e.jsxs(C,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between",children:[e.jsx(w,{children:"Students"}),e.jsx(P,{href:x("admin.students.create"),children:e.jsx(h,{children:"Add Student"})})]}),e.jsx(D,{children:e.jsx(J,{columns:ce(s=>B(s)),data:g})})]}),a&&e.jsx(re,{open:!!a,onOpenChange:s=>{s||B(null)},children:e.jsxs(ie,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsx(de,{children:"Student Details"}),e.jsx(oe,{children:"View detailed information about the student."})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.profile_image?e.jsx("img",{src:a.profile_image,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-2 border-gray-200 shadow-lg"}):e.jsx("div",{className:"w-32 h-32 flex items-center justify-center rounded-full bg-gray-100 text-gray-400 text-sm italic border-2 border-gray-200",children:"No Image"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:[a.name," ",a.surname]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.code})]})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{label:"UID",value:a.uid},{label:"Email",value:a.email},{label:"Phone",value:a.phone},{label:"Grade",value:a.grade},{label:"Gender",value:a.gender},{label:"Nationality",value:a.nationality},{label:"Date of Birth",value:a.dob?new Date(a.dob).toLocaleDateString():"Not specified"},{label:"ID/Passport",value:a.id_passport},{label:"City",value:a.city||"Not specified"},{label:"Country",value:a.country||"Not specified"},{label:"Status",value:a.status?"Active":"Inactive"},{label:"Rating",value:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{rating:typeof a.average_rating=="number"?Math.round(a.average_rating):0,readonly:!0,size:"sm"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[typeof a.average_rating=="number"?a.average_rating.toFixed(1):"0.0"," ","(",a.total_ratings," ","ratings)"]})]})}].map((s,l)=>e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{className:"text-sm font-medium text-muted-foreground",children:s.label}),e.jsx("div",{className:"text-sm",children:s.value})]},l))}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Attachments"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-muted-foreground",children:"ID/Passport Image"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border-2 border-dashed border-gray-200 min-h-[200px] flex items-center justify-center",children:a.id_passport_image?e.jsx("img",{src:a.id_passport_image,alt:"ID/Passport",className:"max-w-full max-h-48 object-contain rounded"}):e.jsx("span",{className:"text-gray-400 italic",children:"No ID/Passport image"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-muted-foreground",children:"Signature Image"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border-2 border-dashed border-gray-200 min-h-[200px] flex items-center justify-center",children:a.signature_image?e.jsx("img",{src:a.signature_image,alt:"Signature",className:"max-w-full max-h-48 object-contain rounded"}):e.jsx("span",{className:"text-gray-400 italic",children:"No signature image"})})]})]})]})]})]})})]})]})}export{ke as default};
