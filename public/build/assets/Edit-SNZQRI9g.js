import{W as B,j as e,Y as D}from"./app-C2xXveN-.js";import{B as N}from"./button-CpLBrkPM.js";import{S as m,a as h,b as x,c as u,e as l}from"./select-_dWkLhpx.js";import{I as f}from"./input-uKThI7IY.js";import{L as n}from"./label-s6w04Ko4.js";import{C as E,a as I,b as M,c as V}from"./card-DbE4vXCG.js";import{A}from"./authenticated-layout-BjG0-HbX.js";import{C as T}from"./react-icons.esm-buVKeGES.js";import{P as F,a as L,b as $}from"./popover-EqWAvmPT.js";import{C as R}from"./calendar-BdWX8fSi.js";import{C as Y}from"./checkbox-ZZvRpILE.js";import{f as C}from"./format-LUeNQFBy.js";import"./index-C9JcK9ps.js";import"./index-D9Tde0Le.js";import"./index-BCtSHVQ3.js";import"./chevron-down-cEcyA7ib.js";import"./sun-wqgmDwy9.js";import"./separator-Be3qWvhY.js";import"./users-BBtCh4Aq.js";import"./log-out-BUfAgkVI.js";function le({payment:t,studentFees:j=[],bank_information:p=[],currencies:y=[]}){var _;const{data:a,setData:v,put:S,processing:b,errors:g}=B({student_fee_id:t.student_fee_id||"",notes:t.notes||"",amount:t.amount||"",status:t.status||"pending",method:t.method||"cash",pay_at:t.pay_at||"",transaction_id:t.transaction_id||"",currency_code:t.currency_code||"MYR",bank_information:((_=t.bank_information)==null?void 0:_.map(s=>s.id))||[]}),r=(s,i)=>{v(s,i)},P=(s,i)=>{const c=a.bank_information,o=i?[...c,s]:c.filter(k=>k!==s);v("bank_information",o)},w=s=>{s.preventDefault(),S(route("admin.payments.update",t.id))},d=s=>g[s]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:g[s]});return e.jsxs(A,{header:"Edit Payment",children:[e.jsx(D,{title:"Edit Payment"}),e.jsx("div",{className:"container mx-auto py-10",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsx(M,{children:"Edit Payment"})}),e.jsx(V,{children:e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(n,{children:["Student Fee",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(m,{value:a.student_fee_id.toString(),onValueChange:s=>r("student_fee_id",s),children:[e.jsx(h,{className:"w-full",children:e.jsx(x,{placeholder:"Select Student Fee"})}),e.jsx(u,{children:j&&j.length>0?j.map(s=>{var i,c,o;return e.jsxs(l,{value:String(s.id),children:[(i=s.student)==null?void 0:i.name," ",(c=s.student)==null?void 0:c.surname," -"," ",(o=s.fee_type)==null?void 0:o.name," (",s.month,")"]},s.id)}):e.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"No student fees available"})})]}),d("student_fee_id")]}),e.jsxs("div",{children:[e.jsxs(n,{children:["Amount",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(f,{type:"number",value:a.amount,onChange:s=>r("amount",s.target.value)}),d("amount")]}),e.jsxs("div",{children:[e.jsxs(n,{children:["Currency",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(m,{value:a.currency_code,onValueChange:s=>r("currency_code",s),children:[e.jsx(h,{className:"w-full",children:e.jsx(x,{placeholder:"Select Currency"})}),e.jsx(u,{children:y.map(s=>e.jsxs(l,{value:s.code,children:[s.code," -"," ",s.symbol," ",s.name]},s.code))})]}),d("currency_code")]}),e.jsxs("div",{children:[e.jsxs(n,{children:["Status",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(m,{value:a.status,onValueChange:s=>r("status",s),children:[e.jsx(h,{className:"w-full",children:e.jsx(x,{placeholder:"Select Status"})}),e.jsxs(u,{children:[e.jsx(l,{value:"pending",children:"Pending"}),e.jsx(l,{value:"successful",children:"Successful"}),e.jsx(l,{value:"failed",children:"Failed"})]})]}),d("status")]}),e.jsxs("div",{children:[e.jsxs(n,{children:["Method",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(m,{value:a.method,onValueChange:s=>r("method",s),children:[e.jsx(h,{className:"w-full",children:e.jsx(x,{placeholder:"Select Method"})}),e.jsxs(u,{children:[e.jsx(l,{value:"cash",children:"Cash"}),e.jsx(l,{value:"card",children:"Card"}),e.jsx(l,{value:"stripe",children:"Stripe"})]})]}),d("method")]}),e.jsxs("div",{children:[e.jsx(n,{children:"Transaction ID"}),e.jsx(f,{type:"text",value:a.transaction_id,onChange:s=>r("transaction_id",s.target.value),placeholder:"Optional transaction ID"}),d("transaction_id")]}),e.jsxs("div",{children:[e.jsx(n,{children:"Pay At"}),e.jsxs(F,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:"w-full justify-start text-left font-normal "+(!a.pay_at&&"text-muted-foreground"),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),a.pay_at?C(new Date(a.pay_at),"PPP"):"Pick a date"]})}),e.jsx($,{className:"w-auto p-0",children:e.jsx(R,{mode:"single",selected:a.pay_at?new Date(a.pay_at):void 0,onSelect:s=>r("pay_at",s?C(s,"yyyy-MM-dd"):""),initialFocus:!0})})]}),d("pay_at")]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{children:"Notes"}),e.jsx(f,{value:a.notes,onChange:s=>r("notes",s.target.value)})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(n,{className:"text-base font-semibold",children:"Bank Information (Select banks to show on invoice)"}),p&&p.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(s=>e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsx(Y,{id:`bank-${s.id}`,checked:a.bank_information.includes(s.id),onCheckedChange:i=>P(s.id,i)}),e.jsxs("div",{className:"flex-1",children:[e.jsx(n,{htmlFor:`bank-${s.id}`,className:"text-sm font-medium cursor-pointer",children:s.bank_name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.account_name," -"," ",s.account_number,s.currency&&` (${s.currency})`]})]})]},s.id))}):e.jsxs("div",{className:"p-4 border border-dashed rounded-lg text-center text-muted-foreground",children:[e.jsx("p",{children:"No bank information available."}),e.jsx("p",{className:"text-sm",children:"Please add bank information first."})]}),d("bank_information")]}),e.jsx("div",{className:"pt-4",children:e.jsx(N,{type:"submit",disabled:b,children:"Save"})})]})})]})})]})}export{le as default};
