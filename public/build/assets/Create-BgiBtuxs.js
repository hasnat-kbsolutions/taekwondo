import{q as N,r as P,j as e,Y as F,y as A}from"./app-CvxQgnLH.js";import{A as I}from"./authenticated-layout-D9qJmpxL.js";import{C as V,a as w,b as D,c as M}from"./card-zvQAZdNH.js";import{L as i}from"./label-C9lA93gH.js";import{I as m}from"./input-6GaB1y2B.js";import{B as h}from"./button-CWcMKvlZ.js";import{S as a,a as o,b as c,c as d,e as s}from"./select-DUr0RVCl.js";import{C as T}from"./calendar-DVOoiQBi.js";import{P as k,a as E,b as L}from"./popover-CAchrxTJ.js";import{C as q}from"./react-icons.esm-COM-t_DY.js";import{f as _}from"./format-LUeNQFBy.js";import"./separator-BukrG-Ui.js";import"./index-aLHJtNDS.js";import"./sun-BoecKOSf.js";import"./users-DxNXTMD0.js";import"./log-out-BTvykz-m.js";import"./index-DqRLdg7_.js";import"./index-DqLt8-f8.js";import"./chevron-down-D3j8lYZa.js";function le(){const{students:x=[],plans:f=[],currencies:y=[],errors:v={}}=N().props,[t,C]=P.useState({studentsel:"",student_id:"",plan_id:"",custom_amount:"",currency_code:"",interval:"monthly",interval_count:"",discount_type:"",discount_value:"",effective_from:"",is_active:!0,notes:""}),u=t.student_id?x.find(n=>n.id===Number(t.student_id)):null,j=u!=null&&u.club_id?f.filter(n=>n.planable_type==="App\\Models\\Club"&&n.planable_id===u.club_id):[],l=(n,b)=>{C(S=>{const p={...S,[n]:b};return n==="student_id"&&(p.plan_id=""),p})},g=n=>{n.preventDefault(),A.post(route("organization.student-fee-plans.store"),{student_id:t.student_id,plan_id:t.plan_id||null,custom_amount:t.custom_amount||null,currency_code:t.currency_code||null,interval:t.interval,interval_count:t.interval==="custom"?Number(t.interval_count||0):null,discount_type:t.discount_type||null,discount_value:t.discount_value?Number(t.discount_value):0,effective_from:t.effective_from||null,is_active:t.is_active,notes:t.notes||null})},r=n=>v[n]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:v[n]});return e.jsxs(I,{header:"Assign Student Fee Plan",children:[e.jsx(F,{title:"Assign Student Fee Plan"}),e.jsx("div",{className:"p-6",children:e.jsxs(V,{children:[e.jsx(w,{children:e.jsx(D,{children:"Assign Student Fee Plan"})}),e.jsx(M,{children:e.jsxs("form",{onSubmit:g,className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Student"}),e.jsxs(a,{value:t.student_id,onValueChange:n=>l("student_id",n),children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Select Student"})}),e.jsx(d,{children:x.map(n=>e.jsxs(s,{value:String(n.id),children:[n.name," ",n.surname||""]},n.id))})]}),r("student_id")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Plan"}),e.jsxs(a,{value:t.plan_id,onValueChange:n=>l("plan_id",n),disabled:!t.student_id,children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Select Plan (or leave blank for custom)"})}),e.jsx(d,{children:j.length>0?j.map(n=>e.jsxs(s,{value:String(n.id),children:[n.name," - ",n.currency_code," ",n.base_amount]},n.id)):e.jsx(s,{value:"none",disabled:!0,children:t.student_id?"No plans available for this student's club":"Select a student first"})})]}),r("plan_id")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Custom Amount (optional)"}),e.jsx(m,{value:t.custom_amount,onChange:n=>l("custom_amount",n.target.value),type:"number"}),r("custom_amount")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Currency (optional)"}),e.jsxs(a,{value:t.currency_code,onValueChange:n=>l("currency_code",n),children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Select Currency"})}),e.jsx(d,{children:y.map(n=>e.jsxs(s,{value:n.code,children:[n.code," - ",n.symbol," ",n.name]},n.code))})]}),r("currency_code")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Interval"}),e.jsxs(a,{value:t.interval,onValueChange:n=>l("interval",n),children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Select Interval"})}),e.jsxs(d,{children:[e.jsx(s,{value:"monthly",children:"Monthly"}),e.jsx(s,{value:"quarterly",children:"Quarterly"}),e.jsx(s,{value:"semester",children:"Semester"}),e.jsx(s,{value:"yearly",children:"Yearly"}),e.jsx(s,{value:"custom",children:"Custom (months)"})]})]}),r("interval")]}),t.interval==="custom"&&e.jsxs("div",{children:[e.jsx(i,{children:"Interval Count (months)"}),e.jsx(m,{value:t.interval_count,onChange:n=>l("interval_count",n.target.value),type:"number",min:1}),r("interval_count")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Discount Type"}),e.jsxs(a,{value:t.discount_type||"",onValueChange:n=>l("discount_type",n==="none"?"":n),children:[e.jsx(o,{children:e.jsx(c,{placeholder:"None"})}),e.jsxs(d,{children:[e.jsx(s,{value:"none",children:"None"}),e.jsx(s,{value:"percent",children:"Percent"}),e.jsx(s,{value:"fixed",children:"Fixed"})]})]}),r("discount_type")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Discount Value"}),e.jsx(m,{value:t.discount_value,onChange:n=>l("discount_value",n.target.value),type:"number",min:0}),r("discount_value")]}),e.jsxs("div",{children:[e.jsx(i,{children:"Effective From"}),e.jsxs(k,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"w-full justify-start text-left font-normal "+(!t.effective_from&&"text-muted-foreground"),children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),t.effective_from?_(new Date(t.effective_from),"PPP"):"Pick a date"]})}),e.jsx(L,{className:"w-auto p-0",children:e.jsx(T,{mode:"single",selected:t.effective_from?new Date(t.effective_from):void 0,onSelect:n=>l("effective_from",n?_(n,"yyyy-MM-dd"):""),initialFocus:!0})})]}),r("effective_from")]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(i,{children:"Notes"}),e.jsx(m,{value:t.notes,onChange:n=>l("notes",n.target.value)}),r("notes")]}),e.jsxs("div",{className:"col-span-2 flex gap-3",children:[e.jsx(h,{type:"submit",children:"Save"}),e.jsx(h,{type:"button",variant:"outline",onClick:()=>history.back(),children:"Cancel"})]})]})})]})})]})}export{le as default};
