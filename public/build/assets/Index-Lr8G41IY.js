import{j as e,b as p,q as Q,r as i,Y as X,y as O}from"./app-v-MKZwHK.js";import{D as Z}from"./DataTable-DHEsa1KD.js";import{B as g}from"./button-y2xYF5vs.js";import{D as ee,a as te,b as ae,c as C,A as se}from"./authenticated-layout-B2ZYBOu0.js";import{B as le}from"./badge-CmqDq2dd.js";import{R as q}from"./RatingStars-CmC7DOGv.js";import{F as re}from"./file-text--6yfePJP.js";import{E as ie}from"./ellipsis-BFGdkXOv.js";import{E as ne}from"./eye-CsYedDQK.js";import{S as oe}from"./square-pen-CoojvQP8.js";import{T as de}from"./trash-2-BCvy34BF.js";import{C as B,a as M,b as R,c as U}from"./card-Bue6HVht.js";import{L as m}from"./label-C5sGq_pi.js";import{S as D,a as I,b as z,c as E,e as d}from"./select-LjE5uhi2.js";import{C as W}from"./country-dropdown-C5dXovmi.js";import{D as ce,a as me,b as ue,c as xe,d as he}from"./dialog-CgX1i5vf.js";import{s as h}from"./index-sFwGSaal.js";import"./table-s978S__J.js";import"./input-DM5ElhjT.js";import"./separator-DeFpeziM.js";import"./index-CLEmplpx.js";import"./createLucideIcon-aeo75YUw.js";import"./building-2-Bma4Oo2b.js";import"./users-Be_mREES.js";import"./log-out-DFR9R_Ks.js";import"./sun-DA2HSJIJ.js";import"./index-afWeK-hQ.js";import"./index-R1Ab9tXC.js";import"./chevron-down-B8hI96OS.js";import"./popover-Q4Aa8K8j.js";import"./globe-B5CYCGgO.js";const pe=f=>[{header:"#",cell:({row:s})=>s.index+1,meta:{sticky:!0,left:"0px",className:"border-r shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] min-w-[60px] w-[60px]"}},{accessorKey:"code",header:"Code",meta:{sticky:!0,left:"60px",className:"border-r shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] min-w-[120px]"}},{accessorKey:"name",header:"Name",cell:({row:s})=>e.jsx(p,{href:route("admin.student-insights.show",s.original.id),className:"text-blue-600 hover:text-blue-800 hover:underline font-medium",children:s.original.name}),meta:{sticky:!0,left:"180px",className:"border-r shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] min-w-[150px]"}},{id:"profile_image",header:"Photo",cell:({row:s})=>{const l=s.original.profile_image;if(l){const x=l.startsWith("http")?l:`/storage/${l}`;return e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:x,alt:"Profile",className:"w-10 h-10 rounded-full object-cover",onError:j=>{var n;j.currentTarget.style.display="none",(n=j.currentTarget.nextElementSibling)==null||n.classList.remove("hidden")}}),e.jsx("span",{className:"text-gray-400 italic text-xs hidden absolute inset-0 flex items-center justify-center",children:"No image"})]})}return e.jsx("span",{className:"text-gray-400 italic",children:"No image"})}},{accessorKey:"surname",header:"Surname"},{accessorKey:"email",header:"Email"},{accessorKey:"dob",header:"DOB"},{accessorKey:"id_passport",header:"ID/Passport"},{accessorKey:"phone",header:"Phone"},{id:"organization",header:"Organization",cell:({row:s})=>{var l;return((l=s.original.organization)==null?void 0:l.name)||"Not specified"}},{id:"club",header:"Club",cell:({row:s})=>{var l;return((l=s.original.club)==null?void 0:l.name)||"Not specified"}},{id:"identification_document",header:"Documents",cell:({row:s})=>{const l=s.original.identification_document;if(l){const x=l.startsWith("http")?l:`/storage/${l}`;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-blue-500"}),e.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-xs underline",children:"View Doc"})]})}return e.jsx("span",{className:"text-gray-400 italic text-xs",children:"No doc"})}},{id:"rating",header:"Rating",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{rating:typeof s.original.average_rating=="number"?Math.round(s.original.average_rating):0,readonly:!0,size:"sm"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",s.original.total_ratings,")"]})]})},{accessorKey:"status",header:"Status",cell:({row:s})=>e.jsx(le,{variant:s.original.status?"default":"destructive",children:s.original.status?"Active":"Inactive"})},{id:"actions",header:"Actions",cell:({row:s})=>{const l=s.original;return e.jsxs(ee,{children:[e.jsx(te,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(ae,{align:"end",children:[e.jsxs(C,{onClick:()=>f(l),children:[e.jsx(ne,{className:"w-4 h-4 mr-2"})," View"]}),e.jsx(C,{asChild:!0,children:e.jsxs(p,{href:route("admin.students.edit",l.id),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"})," Edit"]})}),e.jsx(C,{asChild:!0,children:e.jsxs(p,{href:route("admin.students.destroy",l.id),method:"delete",as:"button",children:[e.jsx(de,{className:"w-4 h-4 mr-2"})," Delete"]})})]})]})}}];function Ye({students:f,organizations:s=[],clubs:l=[],nationalities:x=[],countries:j=[],filters:n}){var L,K,k;const{props:b}=Q(),[ge,G]=i.useState(!1),[fe,H]=i.useState([]),[v,A]=i.useState(n.organization_id||"all"),[N,T]=i.useState(n.club_id||"all"),[y,$]=i.useState(n.nationality||"all"),[_,F]=i.useState(n.country||"all"),[S,P]=i.useState(n.status||"all"),[a,V]=i.useState(null);i.useEffect(()=>{var t;if((t=b.flash)!=null&&t.import_log){const r=b.flash.import_log;let o=r.find(c=>c.summary),J=r.filter(c=>c.status),w=[];o&&w.push(`Total: ${o.total}, Success: ${o.success}, Failed: ${o.failed}, Percentage: ${o.percentage}%`+(o.error?`, Error: ${o.error}`:"")),J.forEach(c=>{w.push(`${c.status==="success"?"✅":"❌"} ${c.message}`)}),H(w),G(!0)}},[(L=b.flash)==null?void 0:L.import_log]);const u=t=>{O.get(h("admin.students.index"),{organization_id:t.organization_id??(v!=="all"?v:null),club_id:t.club_id??(N!=="all"?N:null),nationality:t.nationality??(y||null),country:t.country??(_||null),status:t.status??(S!=="all"?S:null)},{preserveScroll:!0,preserveState:!0,replace:!0})},Y=()=>{A("all"),T("all"),$(""),F(""),P("all"),O.get(h("admin.students.index"),{},{preserveScroll:!0,preserveState:!1,replace:!0})};return e.jsxs(se,{header:"Students",children:[e.jsx(X,{title:"Students"}),e.jsxs("div",{className:"container-fluid py-10 w-full",children:[e.jsxs(B,{children:[e.jsx(M,{className:"flex  flex-row items-center justify-between",children:e.jsx(R,{children:"Import / Export Students"})}),e.jsx(U,{children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:e.jsx(g,{asChild:!0,variant:"outline",children:e.jsx("a",{href:h("admin.students.export"),children:"Export Students"})})})})]}),e.jsxs(B,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between",children:[e.jsx(R,{children:"Students"}),e.jsx(p,{href:h("admin.students.create"),children:e.jsx(g,{children:"Add Student"})})]}),e.jsxs(U,{children:[e.jsx("div",{className:"mb-6 p-4 border rounded-lg bg-muted/50",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"organization",className:"text-sm mb-1",children:"Organization"}),e.jsxs(D,{value:v,onValueChange:t=>{A(t),u({organization_id:t})},children:[e.jsx(I,{id:"organization",className:"w-48",children:e.jsx(z,{placeholder:"All Organizations"})}),e.jsxs(E,{children:[e.jsx(d,{value:"all",children:"All"}),s.map(t=>e.jsx(d,{value:String(t.id),children:t.name},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"club",className:"text-sm mb-1",children:"Club"}),e.jsxs(D,{value:N,onValueChange:t=>{T(t),u({club_id:t})},children:[e.jsx(I,{id:"club",className:"w-48",children:e.jsx(z,{placeholder:"All Clubs"})}),e.jsxs(E,{children:[e.jsx(d,{value:"all",children:"All"}),l.map(t=>e.jsx(d,{value:String(t.id),children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"w-[200px]",children:[e.jsx(m,{className:"text-sm mb-1",children:"Nationality"}),e.jsx(W,{placeholder:"All Nationalities",defaultValue:y||"",onChange:t=>{const r=(t==null?void 0:t.alpha3)||"";$(r),u({nationality:r})},slim:!1})]}),e.jsxs("div",{className:"w-[200px]",children:[e.jsx(m,{className:"text-sm mb-1",children:"Country"}),e.jsx(W,{placeholder:"All Countries",defaultValue:_||"",onChange:t=>{const r=(t==null?void 0:t.alpha3)||"";F(r),u({country:r})},slim:!1})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"status",className:"text-sm mb-1",children:"Status"}),e.jsxs(D,{value:S,onValueChange:t=>{P(t),u({status:t})},children:[e.jsx(I,{id:"status",className:"w-32",children:e.jsx(z,{placeholder:"All Statuses"})}),e.jsxs(E,{children:[e.jsx(d,{value:"all",children:"All"}),e.jsx(d,{value:"active",children:"Active"}),e.jsx(d,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx("div",{children:e.jsx(g,{variant:"secondary",onClick:Y,children:"Reset Filters"})})]})}),e.jsx(Z,{columns:pe(t=>V(t)),data:f})]})]}),a&&e.jsx(ce,{open:!!a,onOpenChange:t=>{t||V(null)},children:e.jsxs(me,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ue,{children:[e.jsx(xe,{children:"Student Details"}),e.jsx(he,{children:"View detailed information about the student."})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.profile_image?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a.profile_image.startsWith("http")?a.profile_image:`/storage/${a.profile_image}`,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-2 border-gray-200 shadow-lg",onError:t=>{var r;t.currentTarget.style.display="none",(r=t.currentTarget.nextElementSibling)==null||r.classList.remove("hidden")}}),e.jsx("div",{className:"w-32 h-32 hidden flex items-center justify-center rounded-full bg-gray-100 text-gray-400 text-sm italic border-2 border-gray-200",children:"No Image"})]}):e.jsx("div",{className:"w-32 h-32 flex items-center justify-center rounded-full bg-gray-100 text-gray-400 text-sm italic border-2 border-gray-200",children:"No Image"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:[a.name," ",a.surname]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.code})]})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{label:"UID",value:a.uid},{label:"Email",value:a.email},{label:"Phone",value:a.phone},{label:"Grade",value:a.grade},{label:"Gender",value:a.gender},{label:"Nationality",value:a.nationality},{label:"Date of Birth",value:a.dob?new Date(a.dob).toLocaleDateString():"Not specified"},{label:"Date of Death",value:a.dod?new Date(a.dod).toLocaleDateString():"Not specified"},{label:"ID/Passport",value:a.id_passport},{label:"Identification Document",value:a.identification_document?e.jsx("a",{href:a.identification_document.startsWith("http")?a.identification_document:`/storage/${a.identification_document}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"View Document"}):"No document uploaded"},{label:"Website",value:a.website||"Not specified"},{label:"Street",value:a.street||"Not specified"},{label:"Postal Code",value:a.postal_code||"Not specified"},{label:"City",value:a.city||"Not specified"},{label:"Country",value:a.country||"Not specified"},{label:"Organization",value:((K=a.organization)==null?void 0:K.name)||"Not specified"},{label:"Club",value:((k=a.club)==null?void 0:k.name)||"Not specified"},{label:"Status",value:a.status?"Active":"Inactive"},{label:"Rating",value:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{rating:typeof a.average_rating=="number"?Math.round(a.average_rating):0,readonly:!0,size:"sm"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[typeof a.average_rating=="number"?a.average_rating.toFixed(1):"0.0"," ","(",a.total_ratings," ","ratings)"]})]})}].map((t,r)=>e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:t.label}),e.jsx("div",{className:"text-sm",children:t.value})]},r))})]})]})})]})]})}export{Ye as default};
