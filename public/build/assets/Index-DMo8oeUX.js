import{r as p,y as $,j as e,Y as H}from"./app-ByP4EyMF.js";import{A as V,q as h,C as j,z as _,E as z,F as q,G}from"./authenticated-layout-Qq67eihM.js";import{C as l,c as n,a as X,b as J}from"./card-CKPA4ccG.js";import{B as K}from"./button-xRIIPuWW.js";import{L as M}from"./label-DlfdlFhI.js";import{B as Q}from"./badge-Dh2Aq8W_.js";import{S as k,a as C,b as D,c as A,e as T}from"./select-DYOzuw-F.js";import{C as u}from"./circle-check-B7xuna73.js";import{C as g}from"./circle-x-D7u-GhdJ.js";import{P as E,i as U,a as Z,b as ee}from"./isWeekend-BrMTysCU.js";import{e as se,a as te,s as L}from"./startOfMonth-Bwwd0hjf.js";import{f as i}from"./format-LUeNQFBy.js";import"./input-DHU4GFng.js";import"./separator-DivMgUP8.js";import"./index-DmN_BMdc.js";import"./sun-w0LeklHu.js";import"./users-BmXZoUBI.js";import"./log-out-DV0RpnIg.js";import"./index-BMO2_zHf.js";import"./index-UrMmZlMe.js";import"./index-C39nNiIL.js";import"./chevron-down-oDmv8qA3.js";function Me({attendance:W,holidays:o={},stats:r,filters:b}){var v;const x=new Date().getFullYear(),N=(new Date().getMonth()+1).toString().padStart(2,"0"),[d,f]=p.useState(((v=b.year)==null?void 0:v.toString())||x.toString()),[c,y]=p.useState(b.month||N);p.useEffect(()=>{const s=setTimeout(()=>{$.get(route("student.attendances.index"),{year:d,month:c},{preserveState:!0,replace:!0,only:["attendance","holidays","stats"]})},300);return()=>clearTimeout(s)},[d,c]);const m=new Date(`${d}-${c}-01`),I=se({start:L(m),end:te(m)}),P=()=>{f(x.toString()),y(N)},Y=s=>{const t=i(s,"yyyy-MM-dd"),a=o[t],S=U(s),R=Z(s),B=ee(s);return{dateStr:t,holiday:a,isWeekendDay:S,isSat:R,isSun:B,isNonWorkingDay:S||!!a}},F=(s,t)=>{if(t&&!s)return e.jsx("span",{className:"text-gray-300",children:"-"});switch(s){case"present":return e.jsx(u,{className:"w-5 h-5 text-green-600"});case"absent":return e.jsx(g,{className:"w-5 h-5 text-red-500"});case"late":return e.jsx(h,{className:"w-5 h-5 text-yellow-500"});case"excused":return e.jsx(j,{className:"w-5 h-5 text-blue-500"});default:return e.jsx("span",{className:"text-gray-300",children:"-"})}},w=r.present+r.absent+r.late+r.excused,O=w>0?Math.round((r.present+r.late)/w*100):0;return e.jsxs(V,{header:"My Attendance",children:[e.jsx(H,{title:"My Attendance"}),e.jsxs("div",{className:"container mx-auto py-5 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(l,{className:"bg-green-50 dark:bg-green-950/20 border-green-200",children:e.jsx(n,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Present"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:r.present})]}),e.jsx(u,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(l,{className:"bg-red-50 dark:bg-red-950/20 border-red-200",children:e.jsx(n,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Absent"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:r.absent})]}),e.jsx(g,{className:"w-8 h-8 text-red-500"})]})})}),e.jsx(l,{className:"bg-yellow-50 dark:bg-yellow-950/20 border-yellow-200",children:e.jsx(n,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-600 font-medium",children:"Late"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:r.late})]}),e.jsx(h,{className:"w-8 h-8 text-yellow-500"})]})})}),e.jsx(l,{className:"bg-blue-50 dark:bg-blue-950/20 border-blue-200",children:e.jsx(n,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Excused"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:r.excused})]}),e.jsx(j,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(l,{className:"bg-purple-50 dark:bg-purple-950/20 border-purple-200",children:e.jsx(n,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Attendance Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[O,"%"]})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-200 flex items-center justify-center",children:e.jsx("span",{className:"text-purple-700 font-bold text-xs",children:"%"})})]})})})]}),e.jsx(l,{children:e.jsx(n,{className:"pt-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm",children:[e.jsx("span",{className:"font-medium",children:"Legend:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded"}),e.jsx("span",{children:"Saturday"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-100 border border-orange-300 rounded"}),e.jsx("span",{children:"Sunday"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-4 h-4 bg-purple-100 border border-purple-300 rounded"}),e.jsx("span",{children:"Holiday"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Present"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{children:"Absent"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{children:"Late"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Excused"})]})]})})}),e.jsxs(l,{children:[e.jsx(X,{children:e.jsx(J,{children:"My Attendance Record"})}),e.jsxs(n,{children:[e.jsx("div",{className:"mb-6 p-4 border rounded-lg bg-muted/50",children:e.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex flex-col w-[200px]",children:[e.jsx(M,{className:"text-sm mb-1",children:"Year"}),e.jsxs(k,{value:d,onValueChange:f,children:[e.jsx(C,{children:e.jsx(D,{placeholder:"Year"})}),e.jsx(A,{children:Array.from({length:5},(s,t)=>(x-t).toString()).map(s=>e.jsx(T,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"flex flex-col w-[200px]",children:[e.jsx(M,{className:"text-sm mb-1",children:"Month"}),e.jsxs(k,{value:c,onValueChange:y,children:[e.jsx(C,{children:e.jsx(D,{placeholder:"Month"})}),e.jsx(A,{children:Array.from({length:12},(s,t)=>{const a=(t+1).toString().padStart(2,"0");return e.jsx(T,{value:a,children:new Date(0,t).toLocaleString("default",{month:"long"})},a)})})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(K,{variant:"secondary",onClick:P,children:"Reset Filters"})})]})}),Object.keys(o).length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-purple-50 dark:bg-purple-950/20 border border-purple-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(E,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-medium text-purple-700",children:"Holidays this month:"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(o).map(([s,t])=>e.jsxs(Q,{variant:"outline",className:"bg-purple-100 text-purple-700 border-purple-300",children:[i(new Date(s),"MMM d")," - ",t.name]},s))})]}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-7 gap-2 min-w-[600px]",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(s=>e.jsx("div",{className:"text-center font-medium text-sm py-2 text-muted-foreground",children:s},s)),Array.from({length:L(m).getDay()}).map((s,t)=>e.jsx("div",{className:"p-2"},`empty-${t}`)),I.map(s=>{const t=Y(s),a=W[t.dateStr];return e.jsxs(z,{children:[e.jsx(q,{asChild:!0,children:e.jsxs("div",{className:`p-3 rounded-lg border text-center cursor-default transition-colors ${t.holiday?"bg-purple-100 dark:bg-purple-900/30 border-purple-300":t.isSun?"bg-orange-100 dark:bg-orange-900/30 border-orange-300":t.isSat?"bg-yellow-100 dark:bg-yellow-900/30 border-yellow-300":"bg-background border-border"}`,children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:i(s,"d")}),e.jsx("div",{className:"flex justify-center",children:F(a,t.isNonWorkingDay)}),t.holiday&&e.jsx(E,{className:"w-3 h-3 mx-auto mt-1 text-purple-600"})]})}),e.jsxs(G,{children:[e.jsx("p",{children:i(s,"EEEE, MMMM d, yyyy")}),a&&e.jsxs("p",{className:"capitalize",children:["Status: ",a]}),t.holiday&&e.jsx("p",{className:"text-purple-400 font-medium",children:t.holiday.name}),t.isWeekendDay&&!t.holiday&&e.jsx("p",{className:"text-yellow-400",children:"Weekend - No Class"})]})]},t.dateStr)})]})})})]})]})]})]})}export{Me as default};
