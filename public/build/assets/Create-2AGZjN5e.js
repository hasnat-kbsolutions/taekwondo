import{W as P,r as c,a as z,j as e,Y as F}from"./app-OMdiln-E.js";import{A as D,t as g}from"./authenticated-layout-DShfHJdr.js";import{B as v}from"./button-DjqBIVTd.js";import{L as l}from"./label-CCvijMRs.js";import{C as B,a as E,b as T,c as V}from"./card-CQTpkTAm.js";import{S as o,a as h,b as m,c as x,d as u,e as p}from"./select-DIrerrpG.js";import{C as k,a as L}from"./calendar-CvR573IG.js";import{P as O,a as R,b as $}from"./popover-BwFNC0ux.js";import{f as I}from"./format-7_oTgTIh.js";import"./input-fIaSY3FD.js";import"./index-a7NDMNNq.js";import"./index-fEr8QWGN.js";function ee({branches:N,organizations:S,clubs:C}){const{data:t,setData:j,post:w,processing:y}=P({date:"",attendances:{}}),[b,_]=c.useState([]),[s,d]=c.useState({branch_id:"",organization_id:"",club_id:""});c.useEffect(()=>{s.branch_id&&s.organization_id&&s.club_id&&z.get(route("admin.students.filter"),{params:s}).then(a=>_(a.data))},[s]);const f=(a,r,n)=>{j("attendances",{...t.attendances,[a]:{...t.attendances[a],[r]:n}})},A=a=>{a.preventDefault(),w(route("admin.attendances.store"),{onSuccess:()=>{g.success("Attendance submitted successfully!")},onError:r=>{g.error("Failed to submit attendance."),console.error(r)}})};return e.jsxs(D,{header:"Record Attendance",children:[e.jsx(F,{title:"Record Attendance"}),e.jsx("div",{className:"container mx-auto py-10",children:e.jsxs(B,{children:[e.jsx(E,{children:e.jsx(T,{children:"New Attendance"})}),e.jsx(V,{children:e.jsxs("form",{onSubmit:A,className:"flex flex-wrap",children:[e.jsxs("div",{className:"w-[50%] px-2",children:[e.jsx(l,{htmlFor:"date",children:"Date"}),e.jsxs(O,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(v,{variant:"outline","data-empty":!t.date,className:"data-[empty=true]:text-muted-foreground w-full justify-start text-left font-normal",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),t.date?I(new Date(t.date),"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx($,{className:"w-auto p-0",children:e.jsx(L,{mode:"single",selected:t.date?new Date(t.date):void 0,onSelect:a=>j("date",a?a.toISOString().split("T")[0]:""),initialFocus:!0})})]})]}),e.jsxs("div",{className:"w-[50%] px-2",children:[e.jsx(l,{htmlFor:"branch",children:"Branch"}),e.jsxs(o,{value:s.branch_id,onValueChange:a=>d({...s,branch_id:a}),children:[e.jsx(h,{className:"w-full p-2 border rounded-lg",children:e.jsx(m,{placeholder:"Select Branch"})}),e.jsx(x,{children:e.jsx(u,{children:N.map(a=>e.jsx(p,{value:String(a.id),children:a.name},a.id))})})]})]}),e.jsxs("div",{className:"w-[50%] px-2 mt-4",children:[e.jsx(l,{htmlFor:"organization",children:"Organization"}),e.jsxs(o,{value:s.organization_id,onValueChange:a=>d({...s,organization_id:a}),children:[e.jsx(h,{className:"w-full p-2 border rounded-lg",children:e.jsx(m,{placeholder:"Select Organization"})}),e.jsx(x,{children:e.jsx(u,{children:S.map(a=>e.jsx(p,{value:String(a.id),children:a.name},a.id))})})]})]}),e.jsxs("div",{className:"w-[50%] px-2 mt-4",children:[e.jsx(l,{htmlFor:"club",children:"Club"}),e.jsxs(o,{value:s.club_id,onValueChange:a=>d({...s,club_id:a}),children:[e.jsx(h,{className:"w-full p-2 border rounded-lg",children:e.jsx(m,{placeholder:"Select Club"})}),e.jsx(x,{children:e.jsx(u,{children:C.map(a=>e.jsx(p,{value:String(a.id),children:a.name},a.id))})})]})]}),b.length>0&&e.jsx("div",{className:"w-full mt-4 overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-2 border-b",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-2 border-b",children:"Attendance"})]})}),e.jsx("tbody",{children:b.map(a=>{var r,n;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 border-b",children:a.name}),e.jsx("td",{className:"px-4 py-2 border-b",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:`attendance-${a.id}`,value:"present",checked:((r=t.attendances[a.id])==null?void 0:r.status)==="present",onChange:i=>f(a.id,"status",i.target.value)}),e.jsx("span",{children:"Present"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:`attendance-${a.id}`,value:"absent",checked:((n=t.attendances[a.id])==null?void 0:n.status)==="absent",onChange:i=>f(a.id,"status",i.target.value)}),e.jsx("span",{children:"Absent"})]})]})})]},a.id)})})]})}),e.jsx("div",{className:"w-[100%] px-2 mt-4",children:e.jsx(v,{type:"submit",disabled:y,children:"Submit Attendance"})})]})})]})})]})}export{ee as default};
