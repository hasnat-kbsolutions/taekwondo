import{q as M,r as T,j as e,Y as k,y as L}from"./app-CC7qpNu6.js";import{A as q}from"./authenticated-layout-Bd5hei_t.js";import{C as B,a as Y,b as H,c as Q}from"./card-CUFGxmYR.js";import{L as o}from"./label-DaD98WMX.js";import{I as _}from"./input-B5ij4QCV.js";import{B as j}from"./button-Dawy7JlE.js";import{S as a,a as c,b as d,c as u,e as i}from"./select-n3OOaBTe.js";import{C as R}from"./calendar-CuXE0pNT.js";import{P as z,a as G,b as J}from"./popover-BCwEgVmg.js";import{C as K}from"./react-icons.esm-Bd2a4Y4N.js";import{f as N}from"./format-LUeNQFBy.js";import"./separator-BtGUCeNx.js";import"./index-AMtJWCSb.js";import"./sun-Cdo4h1aO.js";import"./users-DF6lFF4e.js";import"./log-out-tpPZZpB-.js";import"./index-BCDJZF4r.js";import"./index-BReCHXkN.js";import"./chevron-down--P3qsrMs.js";function ue(){var h,g,v,C,x,b;const{studentFeePlan:n,students:p=[],plans:E=[],currencies:I=[],errors:f={}}=M().props,[r,V]=T.useState({student_id:n!=null&&n.student_id?String(n.student_id):"",plan_id:n!=null&&n.plan_id?String(n.plan_id):"",custom_amount:((g=(h=n==null?void 0:n.custom_amount)==null?void 0:h.toString)==null?void 0:g.call(h))||"",currency_code:(n==null?void 0:n.currency_code)||"",interval:(n==null?void 0:n.interval)||"monthly",interval_count:((C=(v=n==null?void 0:n.interval_count)==null?void 0:v.toString)==null?void 0:C.call(v))||"",discount_type:(n==null?void 0:n.discount_type)||"",discount_value:((b=(x=n==null?void 0:n.discount_value)==null?void 0:x.toString)==null?void 0:b.call(x))||"",effective_from:(n==null?void 0:n.effective_from)||"",is_active:!!(n!=null&&n.is_active),notes:(n==null?void 0:n.notes)||""}),m=r.student_id?p.find(t=>t.id===Number(r.student_id)):null,y=m!=null&&m.club_id?E.filter(t=>t.planable_type==="App\\Models\\Club"&&t.planable_id===m.club_id):[],s=(t,D)=>{V(A=>{const S={...A,[t]:D};return t==="student_id"&&(S.plan_id=""),S})},w=t=>{t.preventDefault(),L.post(route("club.student-fee-plans.update",n.id),{student_id:r.student_id,plan_id:r.plan_id||null,custom_amount:r.custom_amount||null,currency_code:r.currency_code||null,interval:r.interval,interval_count:r.interval==="custom"?Number(r.interval_count||0):null,discount_type:r.discount_type||null,discount_value:r.discount_value?Number(r.discount_value):0,effective_from:r.effective_from||null,is_active:r.is_active,notes:r.notes||null,_method:"put"})},l=t=>f[t]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:f[t]});return e.jsxs(q,{header:"Edit Student Fee Plan",children:[e.jsx(k,{title:"Edit Student Fee Plan"}),e.jsx("div",{className:"p-6",children:e.jsxs(B,{children:[e.jsx(Y,{children:e.jsx(H,{children:"Edit Student Fee Plan"})}),e.jsx(Q,{children:e.jsxs("form",{onSubmit:w,className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Student"}),e.jsxs(a,{value:r.student_id,onValueChange:t=>s("student_id",t),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select Student"})}),e.jsx(u,{children:p.map(t=>e.jsxs(i,{value:String(t.id),children:[t.name," ",t.surname||""]},t.id))})]}),l("student_id")]}),e.jsxs("div",{children:[e.jsx(o,{children:"Plan"}),e.jsxs(a,{value:r.plan_id,onValueChange:t=>s("plan_id",t),disabled:!r.student_id,children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select Plan (or leave blank for custom)"})}),e.jsx(u,{children:y.length>0?y.map(t=>e.jsxs(i,{value:String(t.id),children:[t.name," - ",t.currency_code," ",t.base_amount]},t.id)):e.jsx(i,{value:"none",disabled:!0,children:r.student_id?"No plans available for this student's club":"Select a student first"})})]}),l("plan_id")]}),e.jsxs("div",{children:[e.jsx(o,{children:"Custom Amount (optional)"}),e.jsx(_,{value:r.custom_amount,onChange:t=>s("custom_amount",t.target.value),type:"number"}),l("custom_amount")]}),e.jsxs("div",{children:[e.jsx(o,{children:"Currency (optional)"}),e.jsxs(a,{value:r.currency_code,onValueChange:t=>s("currency_code",t),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select Currency"})}),e.jsx(u,{children:I.map(t=>e.jsxs(i,{value:t.code,children:[t.code," - ",t.symbol," ",t.name]},t.code))})]}),l("currency_code")]}),e.jsxs("div",{children:[e.jsx(o,{children:"Interval"}),e.jsxs(a,{value:r.interval,onValueChange:t=>s("interval",t),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select Interval"})}),e.jsxs(u,{children:[e.jsx(i,{value:"monthly",children:"Monthly"}),e.jsx(i,{value:"quarterly",children:"Quarterly"}),e.jsx(i,{value:"semester",children:"Semester"}),e.jsx(i,{value:"yearly",children:"Yearly"}),e.jsx(i,{value:"custom",children:"Custom (months)"})]})]}),l("interval")]}),r.interval==="custom"&&e.jsxs("div",{children:[e.jsx(o,{children:"Interval Count (months)"}),e.jsx(_,{value:r.interval_count,onChange:t=>s("interval_count",t.target.value),type:"number",min:1}),l("interval_count")]}),e.jsxs("div",{children:[e.jsx(o,{children:"Discount Type"}),e.jsxs(a,{value:r.discount_type||"",onValueChange:t=>s("discount_type",t==="none"?"":t),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"None"})}),e.jsxs(u,{children:[e.jsx(i,{value:"none",children:"None"}),e.jsx(i,{value:"percent",children:"Percent"}),e.jsx(i,{value:"fixed",children:"Fixed"})]})]}),l("discount_type")]}),e.jsxs("div",{children:[e.jsx(o,{children:"Discount Value"}),e.jsx(_,{value:r.discount_value,onChange:t=>s("discount_value",t.target.value),type:"number",min:0}),l("discount_value")]}),e.jsxs("div",{children:[e.jsx(o,{children:"Effective From"}),e.jsxs(z,{children:[e.jsx(G,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:"w-full justify-start text-left font-normal "+(!r.effective_from&&"text-muted-foreground"),children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),r.effective_from?N(new Date(r.effective_from),"PPP"):"Pick a date"]})}),e.jsx(J,{className:"w-auto p-0",children:e.jsx(R,{mode:"single",selected:r.effective_from?new Date(r.effective_from):void 0,onSelect:t=>s("effective_from",t?N(t,"yyyy-MM-dd"):""),initialFocus:!0})})]}),l("effective_from")]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Notes"}),e.jsx(_,{value:r.notes,onChange:t=>s("notes",t.target.value)}),l("notes")]}),e.jsxs("div",{className:"col-span-2 flex gap-3",children:[e.jsx(j,{type:"submit",children:"Save"}),e.jsx(j,{type:"button",variant:"outline",onClick:()=>history.back(),children:"Cancel"})]})]})})]})})]})}export{ue as default};
