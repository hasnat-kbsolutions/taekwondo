import{r as t,j as e,Y as O,b as i,y as P}from"./app-CikEoOUb.js";import{B as c}from"./button-DE34mfwC.js";import{B as R}from"./badge-YCVpdJLF.js";import{A as $,D as H,a as U,b as q,c as d}from"./authenticated-layout-tnqnI4FE.js";import{S as j,a as p,b as f,c as y,e as n}from"./select-D_R4pDbd.js";import{D as z,a as G,b as Q,c as W,d as X,e as Z}from"./dialog-PNNo5n6u.js";import{D as ee}from"./DataTable-BVsypS1V.js";import{C as F,a as E,b as T,c as _}from"./card-B9gfxKxc.js";import{L as g}from"./label-DFDTJu9O.js";import{E as se}from"./ellipsis-CvJy5PQA.js";import{E as ae}from"./eye-Ds39zDLU.js";import{S as te}from"./square-pen-GySVy4y7.js";import{T as le}from"./trash-2-BzQTabuC.js";import{F as ne}from"./file-text-bh0pXV8K.js";import"./input-BghCconx.js";import"./index-CQAMZMT0.js";import"./index-BPaBik1e.js";import"./index-CEUW6_er.js";import"./chevron-down-rq2aknLd.js";import"./table-BDtgScpB.js";const b=new Date().getFullYear(),re=["All",...Array.from({length:5},(v,r)=>(b-r).toString())],ie=[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}];function Me({payments:v,filters:r}){var C,w,D;const[o,S]=t.useState(r.status||""),[m,N]=t.useState(((C=r.payment_month)==null?void 0:C.split("-")[0])||b.toString()),[h,x]=t.useState(((w=r.payment_month)==null?void 0:w.split("-")[1])||""),[a,Y]=t.useState(null),[V,u]=t.useState(!1),I=s=>{Y(s),u(!0)},L=({year:s,month:l,status:A})=>{const M=s==="All"?"":l?`${s}-${l}`:`${s}-01`;console.log("Filter Values:",{year:s,month:l,status:A,paymentMonth:M}),P.get(route("admin.payments.index"),{status:A||null,payment_month:M||null},{preserveScroll:!0,preserveState:!0,replace:!0})},[k,B]=t.useState(!0);t.useEffect(()=>{if(k){B(!1);return}L({year:m,month:h,status:o})},[m,h,o]);const K=()=>{S(""),N(b.toString()),x(""),P.get(route("admin.payments.index"),{},{preserveScroll:!0,preserveState:!1,replace:!0})},J=[{header:"#",cell:({row:s})=>s.index+1},{header:"Student",cell:({row:s})=>{var l;return((l=s.original.student)==null?void 0:l.name)||"-"}},{header:"Amount",accessorKey:"amount"},{header:"Status",cell:({row:s})=>e.jsx(R,{variant:s.original.status==="paid"||s.original.status==="success"?"default":"destructive",children:s.original.status})},{header:"Method",accessorKey:"method"},{header:"Payment Month",accessorKey:"payment_month"},{header:"Pay At",accessorKey:"pay_at"},{header:"Actions",cell:({row:s})=>e.jsxs(H,{children:[e.jsx(U,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(se,{className:"h-4 w-4"})})}),e.jsxs(q,{align:"end",children:[e.jsxs(d,{onClick:()=>I(s.original),children:[e.jsx(ae,{className:"w-4 h-4 mr-2"})," View"]}),e.jsx(d,{asChild:!0,children:e.jsxs(i,{href:route("admin.payments.edit",s.original.id),children:[e.jsx(te,{className:"w-4 h-4 mr-2"})," Edit"]})}),e.jsx(d,{asChild:!0,children:e.jsxs(i,{href:route("admin.payments.destroy",s.original.id),method:"delete",as:"button",children:[e.jsx(le,{className:"w-4 h-4 mr-2"})," Delete"]})}),e.jsx(d,{asChild:!0,children:e.jsxs(i,{href:route("admin.payments.invoice",{payment:s.original.id}),children:[e.jsx(ne,{className:"w-4 h-4 mr-2"})," Invoice"]})})]})]})}];return e.jsxs($,{header:"Payments",children:[e.jsx(O,{title:"Payments"}),e.jsxs("div",{className:"container mx-auto py-10 space-y-6",children:[e.jsxs(F,{children:[e.jsx(E,{children:e.jsx(T,{children:"Filters"})}),e.jsx(_,{children:e.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(g,{className:"text-sm mb-1",children:"Year"}),e.jsxs(j,{value:m,onValueChange:s=>{N(s),s==="All"&&x("")},children:[e.jsx(p,{children:e.jsx(f,{placeholder:"Year"})}),e.jsx(y,{children:re.map(s=>e.jsx(n,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(g,{className:"text-sm mb-1",children:"Month"}),e.jsxs(j,{value:h,onValueChange:s=>x(s==="all"?"":s),children:[e.jsx(p,{children:e.jsx(f,{placeholder:"Month"})}),e.jsxs(y,{children:[e.jsx(n,{value:"all",children:"All"}),ie.map(s=>e.jsx(n,{value:s.value,children:s.label},s.value))]})]})]}),e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(g,{className:"text-sm mb-1",children:"Status"}),e.jsxs(j,{value:o,onValueChange:s=>S(s==="all"?"":s),children:[e.jsx(p,{children:e.jsx(f,{placeholder:"All Statuses"})}),e.jsxs(y,{children:[e.jsx(n,{value:"all",children:"All"}),e.jsx(n,{value:"paid",children:"Paid"}),e.jsx(n,{value:"unpaid",children:"Unpaid"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(c,{onClick:K,children:"Reset Filters"})})]})})]}),e.jsxs(F,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between",children:[e.jsx(T,{children:"Payments"}),e.jsx(i,{href:route("admin.payments.create"),children:e.jsx(c,{children:"Add Payment"})})]}),e.jsx(_,{children:e.jsx(ee,{data:v,columns:J})})]}),e.jsx(z,{open:V,onOpenChange:u,children:e.jsxs(G,{className:"w-full",children:[e.jsxs(Q,{children:[e.jsx(W,{className:"text-3xl text-foreground",children:"Edit Payment"}),e.jsx(X,{className:"text-muted-foreground",children:"Update payment details like amount and status."})]}),a&&e.jsxs("div",{className:"space-y-2 text-sm ",children:[e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Student:"})," ",(D=a.student)==null?void 0:D.name]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Amount:"})," RM"," ",a.amount]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Status:"})," ",a.status]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Method:"})," ",a.method]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Payment Month:"})," ",a.payment_month]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Pay At:"})," ",a.pay_at]}),a.notes&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Notes:"})," ",a.notes]})]}),e.jsx(Z,{children:e.jsx(c,{onClick:()=>u(!1),children:"Close"})})]})})]})]})}export{Me as default};
