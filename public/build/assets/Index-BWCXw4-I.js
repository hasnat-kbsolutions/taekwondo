import{r as a,j as e,Y as Q,b as d,y as T}from"./app-BR5-CEIF.js";import{B as m}from"./button-Cca4UGjE.js";import{B as W}from"./badge-iU7xgOkS.js";import{A as X,D as Z,a as ee,b as se,c as u}from"./authenticated-layout-40O3gxwF.js";import{S as x,a as h,b as j,c as p,e as n}from"./select-1qlA7r9H.js";import{D as te,a as le,b as ae,c as ne,d as re,e as ie}from"./dialog-HHDjdTgm.js";import{D as ce}from"./DataTable-Cuut-RDv.js";import{C as V,a as L,b as I,c as R}from"./card-ruYL3A7M.js";import{L as f}from"./label-BDgUDZin.js";import{E as oe}from"./ellipsis-BVQm6Kqu.js";import{E as de}from"./eye-ClErgVlF.js";import{S as me}from"./square-pen-PkR93ycs.js";import{T as ue}from"./trash-2-tnw0Vdgk.js";import{F as xe}from"./file-text-JJcF4wQV.js";import"./input-9fZl11cf.js";import"./separator-CyMiBi14.js";import"./index-C-3bd_PS.js";import"./sun-dpwYLMUn.js";import"./users-01x0WH6Z.js";import"./log-out-BAV1vg21.js";import"./index-BGVnSqQZ.js";import"./index-BJCw8Nab.js";import"./chevron-down-DNVP3pWD.js";import"./table-CceDNIfo.js";const C=new Date().getFullYear(),he=["All",...Array.from({length:5},(w,c)=>(C-c).toString())],je=[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}];function Be({payments:w,filters:c,currencies:k}){var P,_,F,E;const[y,A]=a.useState(c.status||""),[g,M]=a.useState(((P=c.payment_month)==null?void 0:P.split("-")[0])||C.toString()),[b,v]=a.useState(((_=c.payment_month)==null?void 0:_.split("-")[1])||""),[S,D]=a.useState(c.currency_code||""),B=(s,t)=>{const r=Number(s)||0;return t==="JPY"?r.toLocaleString():r.toFixed(2)},[l,J]=a.useState(null),[K,N]=a.useState(!1),O=s=>{J(s),N(!0)},$=({year:s,month:t,status:r,currency:i})=>{const o=s==="All"?"":t?`${s}-${t}`:`${s}-01`;console.log("Filter Values:",{year:s,month:t,status:r,currency:i,paymentMonth:o}),T.get(route("admin.payments.index"),{status:r||null,payment_month:o||null,currency_code:i||null},{preserveScroll:!0,preserveState:!0,replace:!0})},[H,U]=a.useState(!0);a.useEffect(()=>{if(H){U(!1);return}$({year:g,month:b,status:y,currency:S})},[g,b,y,S]);const q=()=>{A(""),M(C.toString()),v(""),D(""),T.get(route("admin.payments.index"),{},{preserveScroll:!0,preserveState:!1,replace:!0})},z=[{header:"#",cell:({row:s})=>s.index+1},{header:"Student",cell:({row:s})=>{var t;return((t=s.original.student)==null?void 0:t.name)||"-"}},{header:"Amount",cell:({row:s})=>{var Y;const t=s.original,r=t.amount,i=t.currency_code,o=((Y=t.currency)==null?void 0:Y.symbol)||i,G=B(r,i);return e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:[i==="MYR"?"RM ":o,G]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:i})]})}},{header:"Status",cell:({row:s})=>e.jsx(W,{variant:s.original.status==="paid"||s.original.status==="success"?"default":"destructive",children:s.original.status})},{header:"Method",accessorKey:"method"},{header:"Payment Month",accessorKey:"payment_month"},{header:"Pay At",accessorKey:"pay_at"},{header:"Actions",cell:({row:s})=>e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsxs(se,{align:"end",children:[e.jsxs(u,{onClick:()=>O(s.original),children:[e.jsx(de,{className:"w-4 h-4 mr-2"})," View"]}),e.jsx(u,{asChild:!0,children:e.jsxs(d,{href:route("admin.payments.edit",s.original.id),children:[e.jsx(me,{className:"w-4 h-4 mr-2"})," Edit"]})}),e.jsx(u,{asChild:!0,children:e.jsxs(d,{href:route("admin.payments.destroy",s.original.id),method:"delete",as:"button",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"})," Delete"]})}),e.jsx(u,{asChild:!0,children:e.jsxs(d,{href:route("admin.payments.invoice",{payment:s.original.id}),children:[e.jsx(xe,{className:"w-4 h-4 mr-2"})," Invoice"]})})]})]})}];return e.jsxs(X,{header:"Payments",children:[e.jsx(Q,{title:"Payments"}),e.jsxs("div",{className:"container mx-auto py-10 space-y-6",children:[e.jsxs(V,{children:[e.jsx(L,{children:e.jsx(I,{children:"Filters"})}),e.jsx(R,{children:e.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(f,{className:"text-sm mb-1",children:"Year"}),e.jsxs(x,{value:g,onValueChange:s=>{M(s),s==="All"&&v("")},children:[e.jsx(h,{children:e.jsx(j,{placeholder:"Year"})}),e.jsx(p,{children:he.map(s=>e.jsx(n,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(f,{className:"text-sm mb-1",children:"Month"}),e.jsxs(x,{value:b,onValueChange:s=>v(s==="all"?"":s),children:[e.jsx(h,{children:e.jsx(j,{placeholder:"Month"})}),e.jsxs(p,{children:[e.jsx(n,{value:"all",children:"All"}),je.map(s=>e.jsx(n,{value:s.value,children:s.label},s.value))]})]})]}),e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(f,{className:"text-sm mb-1",children:"Status"}),e.jsxs(x,{value:y,onValueChange:s=>A(s==="all"?"":s),children:[e.jsx(h,{children:e.jsx(j,{placeholder:"All Statuses"})}),e.jsxs(p,{children:[e.jsx(n,{value:"all",children:"All"}),e.jsx(n,{value:"paid",children:"Paid"}),e.jsx(n,{value:"unpaid",children:"Unpaid"})]})]})]}),e.jsxs("div",{className:"flex flex-col w-[160px]",children:[e.jsx(f,{className:"text-sm mb-1",children:"Currency"}),e.jsxs(x,{value:S,onValueChange:s=>D(s==="all"?"":s),children:[e.jsx(h,{children:e.jsx(j,{placeholder:"All Currencies"})}),e.jsxs(p,{children:[e.jsx(n,{value:"all",children:"All"}),k.map(s=>e.jsxs(n,{value:s.code,children:[s.code," -"," ",s.symbol]},s.code))]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(m,{onClick:q,children:"Reset Filters"})})]})})]}),e.jsxs(V,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between",children:[e.jsx(I,{children:"Payments"}),e.jsx(d,{href:route("admin.payments.create"),children:e.jsx(m,{children:"Add Payment"})})]}),e.jsx(R,{children:e.jsx(ce,{data:w,columns:z})})]}),e.jsx(te,{open:K,onOpenChange:N,children:e.jsxs(le,{className:"w-full",children:[e.jsxs(ae,{children:[e.jsx(ne,{className:"text-3xl text-foreground",children:"Edit Payment"}),e.jsx(re,{className:"text-muted-foreground",children:"Update payment details like amount and status."})]}),l&&e.jsxs("div",{className:"space-y-2 text-sm ",children:[e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Student:"})," ",(F=l.student)==null?void 0:F.name]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Amount:"})," ",((E=l.currency)==null?void 0:E.symbol)||"RM"," ",l.amount," (",l.currency_code,")"]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Status:"})," ",l.status]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Method:"})," ",l.method]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Payment Month:"})," ",l.payment_month]}),e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Pay At:"})," ",l.pay_at]}),l.notes&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("strong",{children:"Notes:"})," ",l.notes]})]}),e.jsx(ie,{children:e.jsx(m,{onClick:()=>N(!1),children:"Close"})})]})})]})]})}export{Be as default};
